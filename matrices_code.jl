
function days_vac_f(l::Int64)

    v = [i for i in p.day_inital_vac:(p.day_inital_vac+(l-2))]
    
    return v
end

function vaccination_rate_1(sim::Int64)
    #must be written as the temporal series of vaccines per age group
    if p.prov == :ontario
        #p.day_inital_vac = 104
        v = [0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 162 543
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 37 72
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 63 320
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 107 679
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 221 879
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 1273 741
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 1948 302
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 1302 127
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 1311 1477 1686 3614 5786 775 78
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 286 382 1077 1511 1577 329 53
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 392 517 1154 1175 1099 212 44
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 1070 1059 1143 1236 670 150 40
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 1665 1409 1100 1115 450 118 35
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 1730 1432 1104 947 272 81 27
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 1457 1134 775 606 190 61 23
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 2402 1325 974 661 396 149 43 43
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 772 796 591 429 244 107 58 40
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 515 462 322 195 138 75 51 30
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 306 364 243 158 160 70 9 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 176 272 189 125 105 59 25 10
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 123 261 179 127 110 65 27 10
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 171 239 163 113 98 60 25 9
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 145 199 139 104 91 57 26 9
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 149 168 121 91 78 49 23 9
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 99 115 85 61 51 32 14 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 89 124 90 65 55 33 15 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 91 145 101 72 59 33 14 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 89 149 103 74 56 30 12 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 93 182 118 79 58 31 12 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 98 249 154 102 72 38 15 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 73 190 135 87 64 34 13 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 75 229 150 98 71 38 16 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 64 174 119 79 59 33 14 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 52 148 110 74 56 32 13 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 42 109 82 55 44 23 9 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 41 101 80 54 41 25 10 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 32 83 64 43 34 20 9 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 27 67 52 34 27 16 7 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 26 64 51 32 25 15 9 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 25 66 49 30 25 15 8 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                571 21 54 41 26 21 14 8 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                877 0 0 59 0 0 170 187 136
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                755 14 40 37 21 13 17 10 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                473 13 40 34 19 17 23 13 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                291 3 54 44 26 17 37 26 17
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                194 11 38 25 15 13 11 5 2
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                201 10 71 48 26 20 22 11 1
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                234 15 84 57 30 25 28 14 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                167 12 82 51 25 18 21 12 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                97 8 73 43 22 13 18 11 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                56 9 68 40 19 10 14 8 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                40 8 60 31 16 8 13 10 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                20 4 47 23 10 3 12 9 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                13 1 28 16 7 2 9 7 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                8 0 20 13 7 0 8 5 0
        ]

    else
        error("no state set")
    end
    

    return v
end

function vaccination_rate_2(sim::Int64)
    #must be written as the temporal series of vaccines per age group
    
    
    if p.prov == :ontario
        v = [0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 109 363
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 14 39
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 9 35
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 13 58
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 11 53
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 9 38
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 13 38
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 12 16
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 231 275 299 364 283 14 23
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 7 8 10 14 20 21 19
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 9 9 10 15 21 21 16
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 10 11 14 20 26 23 15
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 33 35 38 47 46 30 16
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 117 129 132 143 99 44 21
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 142 161 165 192 299 61 36
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 23 174 188 199 261 369 354 768
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 24 341 375 405 668 1207 1439 707
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 91 737 758 817 1257 1637 1451 520
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 188 1073 1112 1379 1831 1666 1122 335
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 379 1580 1486 1470 1775 1566 820 280
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 693 1738 1514 1485 1539 1156 445 199
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 841 1415 1141 1050 1058 721 313 150
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 678 1029 824 748 752 498 268 86
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 507 676 514 458 453 319 163 48
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 307 439 330 275 265 184 83 25
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 268 390 294 236 226 155 60 20
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 227 318 230 180 168 112 42 16
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 195 268 189 150 131 80 32 13
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 153 218 144 109 92 55 23 9
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 122 292 183 130 104 58 23 9
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 95 259 172 119 99 55 22 9
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 119 366 220 149 111 57 23 10
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 113 315 186 127 94 51 21 8
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 102 270 173 117 89 48 19 8
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 85 221 147 99 72 37 14 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 80 206 145 98 74 41 17 7
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 64 177 129 86 67 37 15 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 53 132 100 63 52 29 12 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 50 120 94 63 48 27 12 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 45 114 85 55 44 25 11 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                209 35 90 70 45 36 21 10 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 77 0 0 186 212 189
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 20 65 53 31 23 22 12 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 16 57 45 25 22 23 12 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                11 0 56 42 27 17 34 24 17
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                54 12 32 22 14 12 7 3 1
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                144 3 63 45 26 20 20 10 1
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                243 7 70 51 31 24 26 13 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                294 7 73 48 26 20 19 12 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                514 13 78 48 26 16 20 12 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                414 16 90 53 27 16 17 9 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                315 14 85 45 24 15 17 11 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                227 10 68 36 18 9 16 10 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                137 6 43 25 12 7 11 8 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                106 4 33 21 11 2 10 6 0
        ]
    else
        error("no state set")
    end


    return v
end


function temporal_proportion()
    
    if p.prov == :ontario
        v = [1]
        fd = [0.78 0.22 0.0]
        sd = [0.78 0.22 0.0]

    else
       error("no distribution for proportion")
    end

    if !p.using_jj
        sd[:,3] .= 0
        fd[:,3] .= 0
    end

    return v,fd,sd
end


function get_breaks_vac()

    if p.prov == :ontario
        brak = @SVector [5:11,12:17, 18:29, 30:39, 40:49, 50:59,60:69, 70:79, 80:100]
    else
        #brak = @SVector [12:15, 16:17, 18:24, 25:39, 40:49, 50:64, 65:74, 75:100]
        error("no age breaks")
    end
    return brak
end


function waning_factor()
    M = [1	1	1	1
            0.9985	0.9972	1	1
            0.9951	0.9934	1	1
            0.9897	0.9885	1	1
            0.9824	0.9825	1	1
            0.9733	0.9756	0.9989	1
            0.9623	0.9676	0.9967	1
            0.9496	0.9587	0.9935	1
            0.9352	0.9488	0.9891	1
            0.9192	0.9381	0.9837	1
            0.9016	0.9264	0.9772	1
            0.8827	0.9139	0.9697	0.9987
            0.8625	0.9006	0.9612	0.9961
            0.8411	0.8866	0.9517	0.9923
            0.8186	0.8718	0.9413	0.9872
            0.7951	0.8563	0.9299	0.9809
            0.7708	0.8402	0.9177	0.9733
            0.7457	0.8235	0.9046	0.9646
            0.7201	0.8063	0.8907	0.9547
            0.6939	0.7886	0.8761	0.9436
            0.6674	0.7705	0.8608	0.9315
            0.6406	0.7519	0.8448	0.9183
            0.6137	0.733	0.8282	0.9041
            0.5868	0.7138	0.811	0.889
            0.5599	0.6944	0.7933	0.873
            0.5332	0.6747	0.7751	0.8562
            0.5068	0.655	0.7565	0.8386
            0.4808	0.6351	0.7375	0.8203
            0.4551	0.6151	0.7182	0.8014
            0.43	0.5951	0.6987	0.7819
            0.4055	0.5752	0.6789	0.7618
            0.3816	0.5553	0.659	0.7414
            0.3585	0.5356	0.6389	0.7205
            0.336	0.5159	0.6188	0.6994
            0.3144	0.4965	0.5986	0.678
            0.2936	0.4773	0.5785	0.6564
            0.2736	0.4583	0.5584	0.6347
            0.2544	0.4396	0.5384	0.6129
            0.2362	0.4213	0.5185	0.5911
            0.2188	0.4032	0.4989	0.5694
            0.2023	0.3855	0.4794	0.5478
            0.1867	0.3682	0.4602	0.5263
            0.1719	0.3513	0.4413	0.5051
            0.158	0.3348	0.4227	0.4841
            0.1449	0.3187	0.4044	0.4634
            0.1327	0.3031	0.3865	0.443
            0.1212	0.2879	0.369	0.423
            0.1105	0.2732	0.3519	0.4034
            0.1006	0.259	0.3352	0.3842
            0.0914	0.2452	0.3189	0.3655
            0.0828	0.2319	0.3031	0.3473
            0.0749	0.2192	0.2878	0.3296
            0.0677	0.2068	0.2729	0.3124
            0.061	0.195	0.2586	0.2958
            0.0548	0.1837	0.2447	0.2797
            0.0492	0.1728	0.2313	0.2642
            0.0441	0.1624	0.2184	0.2492
            0.0394	0.1524	0.2059	0.2348
            0.0352	0.1429	0.194	0.2209
            0.0313	0.1339	0.1826	0.2077
            0.0278	0.1253	0.1716	0.195
            0.0247	0.1171	0.1612	0.1828
            0.0219	0.1093	0.1512	0.1712
            0.0193	0.102	0.1416	0.1602
            0.017	0.095	0.1325	0.1497
            0.015	0.0884	0.1239	0.1397
            0.0132	0.0822	0.1157	0.1303
            0.0115	0.0763	0.1079	0.1213
            0.0101	0.0708	0.1005	0.1128
            0.0088	0.0656	0.0936	0.1048
            0.0077	0.0607	0.087	0.0973
            0.0067	0.0562	0.0808	0.0901
            0.0058	0.0519	0.0749	0.0835
            0.005	0.0479	0.0694	0.0772
            0.0043	0.0441	0.0643	0.0713
            0.0037	0.0406	0.0594	0.0658
            0.0032	0.0374	0.0549	0.0606
            0.0028	0.0343	0.0506	0.0558
            0.0024	0.0315	0.0467	0.0513
            0.002	0.0289	0.0429	0.0471
            0.0017	0.0264	0.0395	0.0432
            0.0015	0.0242	0.0363	0.0396
            0.0013	0.0221	0.0333	0.0363
            0.0011	0.0202	0.0305	0.0332
            0.0009	0.0184	0.0279	0.0303
            0.0008	0.0168	0.0255	0.0276
            0.0006	0.0152	0.0233	0.0252
            0.0005	0.0139	0.0213	0.0229
            0.0005	0.0126	0.0194	0.0209
            0.0004	0.0114	0.0176	0.0189
            0.0003	0.0103	0.016	0.0172
            0.0003	0.0093	0.0146	0.0156
            0.0002	0.0085	0.0132	0.0141
            0.0002	0.0076	0.012	0.0127
            0.0002	0.0069	0.0109	0.0115
            0.0001	0.0062	0.0098	0.0104
            0.0001	0.0056	0.0089	0.0094
            0.0001	0.005	0.008	0.0084
            0.0001	0.0045	0.0072	0.0076
            0.0001	0.004	0.0065	0.0068
    ]

    return M
end


function booster_doses()

    if p.prov == :ontario
        v = [0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                7457
                0
                0
                0
                0
                0
                0
                5007
                0
                0
                0
                0
                0
                0
                7052
                0
                0
                0
                0
                0
                0
                5329
                0
                0
                0
                0
                0
                0
                6756
                0
                0
                0
                0
                0
                0
                5729
                0
                0
                0
                0
                0
                0
                3391
                0
                0
                0
                0
                0
                0
                0
                2279
                0
                0
                0
                0
                0
                0
                1504
                0
                0
                0
                0
                0
                0
                1022
                0
                0
                0
                0
                0
                0
                863
                0
                0
                0
                0
                0
                0
                615
                0
                0
                0
                0
                0
                0
                406          
        ]
    end

    
    return v
end

function vector_probs()
    #this must be written as the reverse vector of incidence
    if p.prov == :ontario
        v = [
                0.00211848497404017
                0.00177659436313377
                0.000950579579677739
                0.000985917110520778
                0.0014408878201249
                0.00178012811621807
                0.00188172351739181
                0.00187730632603643
                0.00172005431378491
                0.00106719343145977
                0.000948812703135587
                0.00157870419041275
                0.00170503586317661
                0.00184196879519339
                0.00199833736917383
                0.00173065557303782
                0.00103892340678534
                0.0011617213264649
                0.00176775998042301
                0.00206547867777561
                0.00214410468390137
                0.00212378560366662
                0.00125889953628325
                0.00113256786351939
                0.00117939009188641
                0.00173683964093535
                0.00198243548029447
                0.00206459523950453
                0.00205576085679377
                0.00223686570236435
                0.00140731716582401
                0.00155926854844908
                0.00200098768398706
                0.00260084227004764
                0.00256815505401783
                0.00282788590571417
                0.0027934318131422
                0.00184815286309092
                0.00184461911000662
                0.00255048628859631
                0.00283053622052739
                0.00357527468304443
                0.00362033003486931
                0.00345336020163595
                0.00231637514676118
                0.00268830265888416
                0.00349841555346083
                0.00428909280607381
                0.00471491005273243
                0.00516988076233655
                0.00474229663913579
                0.00302489264016411
                0.00423166931845388
                0.00515309543518611
                0.00571849592867473
                0.0063298352122593
                0.00685283066873627
                0.00507446942906035
                0.0062600435888443
                0.00752777750783831
                0.00923192993274384
                0.00948105952518727
                0.00968601720407689
                0.00875398982809175
                0.00864267660593617
                0.00702421769332501
                0.00857465185906333
                0.0105650382837975
                0.0118045021781171
                0.0105120319875329
                0.0117841830978823
                0.0102319820556018
                0.0100287912532544
                0.0119953248446695
                0.0147657872627637
                0.0162950189099962
                0.0147649038244926
                0.0121976322087459
                0.00921956179694878
                0.0077963427422454
                0.00832022163699345
                0.00868066445159244
                0.00919835927844296
                0.00845538769246807
                0.00511510758952984
                0.00387210994212596
                0.00305051235002531
                0.00334293041775146
                0.00369012165828431
                0.00291622973282176
                0.00275986115884132
                0.00213880405427491
                0.00159725639410535
                0.00126243328936756
                0.00135696118437268
                0.00130395488810813
                0.00141968530161908
                0.00128363580787338
                0.001139635369688
                0.00089138921551565
                0.000819830715558496
                0.000783609746444382
                0.00104599091295394
                0.000930260499442992
                0.000910824857479321
                0.000847217301961851
                0.000689081851439253
                0.000606922092229189
                0.000696149357607861
                0.000851634493317231
                0.000754456283498875
                0.00081894727728742
                0.000660811826764823
                0.000522112018205896
                0.000541547660169567
                0.000553915795964631
                0.000654627758867291
                0.000643143061343303
                0.000700566548963241
                0.000628124610735012
                0.000452320394790895
                0.00042493380838754
                0.000487657925633933
                0.000588369888536593
                0.000583952697181213
                0.000528296086103428
                0.00056716737003077
                0.000401080975068489
                0.000389596277544501
                0.000424050370116464
                0.000561866740404314
                0.000448786641706591
                0.000497375746615769
                0.000386945962731273
                0.000333939666466715
                0.000292418067726145
                0.000372810950394058
                0.000300369012165828
                0.000314504024503044
                0.00037016063558083
                0.00036132625287007
                0.000283583685015385
                0.000237644894919435
                0.000288000876370765
                0.000326872160298107
                0.000329522475111335
                0.000434651629369375
                0.000364860005954374
                0.000268565234407094
                0.000289767752912917
                0.000329522475111335
                0.000391363154086653
                0.000429350999742919
                0.000438185382453679
                0.000368393759038678
                0.000270332110949246
                0.000344540925719627
                0.000404614728152792
                0.000472639475025642
                0.000577768629283682
                0.000506210129326529
                0.000518578265121592
                0.00042051661703216
                0.000378995018291589
                0.000451436956519819
                0.00051239419722406
                0.00062194054283748
                0.000590136765078745
                0.00057158456138615
                0.000437301944182603
                0.0004116822343214
                0.000541547660169567
                0.000576885191012606
                0.000565400493488618
                0.000642259623072227
                0.000598087709518429
                0.000409031919508172
                0.000507093567597604
                0.000538897345356339
                0.000631658363819316
                0.000725302820553368
                0.000702333425505393
                0.000763290666209635
                0.000523878894748048
                0.000509743882410832
                0.00053006296264558
                0.000692615604523557
                0.000757106598312103
                0.000749155653872419
                0.000704983740318621
                0.000489424802176085
                0.000498259184886845
                0.000513277635495136
                0.000716468437842608
                0.000833965727895712
                0.000712934684758305
                0.000764174104480711
                0.000579535505825834
                0.000463805092314882
                0.00061310616012672
                0.000653744320596215
                0.000737670956348432
                0.000689965289710329
                0.000598971147789505
                0.000583069258910138
                0.000429350999742919
                0.000564517055217542
                0.000637842431716847
                0.000608688968771341
                0.000574234876199378
                0.000469105721941338
                0.000428467561471843
                0.000307436518334436
                0.000464688530585958
                0.000451436956519819
                0.000510627320681908
                0.000450553518248743
                0.000453203833061971
                0.000286233999828613
                0.000283583685015385
                0.000287117438099689
                0.000373694388665134
                0.000333939666466715
                0.000300369012165828
                0.000188172351739181
                0.000122797919679559
                0.000144883876456458
                0.000148417629540762
                0.000192589543094561
                0.000227927073937599
                0.000199657049263168
                0.000192589543094561
                0.000139583246830003
                0.0001139635369688
                0.00010512915425804
                0.000151951382625066
                0.000150184506082914
                0.000169620148046585
                0.000163436080149054
                0.000119264166595255
                0.000112196660426648
                0.000114846975239876
                0.000156368573980446
                0.00015548513570937
                0.000140466685101079
                0.000126331672763863
                0.000135166055474623
                0.000128981987577091
                0.00010071196290266
                0.00014665075299861
                0.000158135450522598
                0.000161669203606902
                0.000185522036925953
                0.000171387024588737
                0.000215558938142536
                0.000150184506082914
                0.000188172351739181
                0.000184638598654877
                0.000176687654215193
                0.000250896468985574
                0.000162552641877978
                0.000264148043051714
                0.000185522036925953
                0.000253546783798802
                0.000305669641792284
                0.000226160197395447
                0.000261497728238486
                0.000225276759124371
                0.000261497728238486
                0.000238528333190511
                0.000280933370202157
                0.000313620586231968
                0.000304786203521208
                0.000326872160298107
                0.000339240296093171
                0.000261497728238486
                0.000394896907170957
                0.000468222283670262
                0.000443486012080135
                0.000507093567597604
                0.00052122857993482
                0.000363093129412222
                0.000414332549134628
                0.000463805092314882
                0.000585719573723365
                0.000657278073680519
                0.000807462579763433
                0.00076859129583609
                0.000647560252698683
                0.0006175233514821
                0.000809229456305585
                0.000912591734021473
                0.000933794252527296
                0.0011246169190797
                0.00100270243767122
                0.000967364906828183
                0.000917892363647929
                0.00127745173997585
                0.00149389411638946
                0.00158488825831028
                0.00166969833233358
                0.00212025185058232
                0.00140289997446863
                0.00142763624605876
                0.00191706104823485
                0.00194268075809605
                0.0022828044924603
                0.00208668119628143
                0.00243740618989859
                0.00204957678889624
                0.00183136753594048
                0.00239941834424232
                0.00284113747978031
                0.00253016720836157
                0.00279696556622651
                0.00302489264016411
                0.00259819195523442
                0.00246567621457302
                0.00303549389941702
                0.0032969916276555
                0.00297630353525493
                0.00343392455967228
                0.00341978954733506
                0.00307436518334436
                0.00288442595506303
                0.00310086833147664
                0.00348693085593684
                0.003616796281785
                0.00397988941119723
                0.00325281971410171
                0.00372104199777197
                0.00306464736236253
                0.00392864999147482
                0.00375461265207286
                0.00385355773843336
                0.00425110496041755
                0.00418396365181577
                0.00367156945459171
                0.0032422184548488
                0.00388801183100533
                0.0039366009359145
                0.00336855012761266
                0.00373429357183811
                0.00291092910319531
                0.00284025404150923
                0.00270773830084784
                0.00259554164042119
                0.00268653578234201
                0.00265826575766758
                0.00272894081935366
                0.00225895165914124
                0.00206106148642023
                0.00206371180123346
                0.00184991973963307
                0.00216265688759396
                0.00216707407894934
                0.00191617760996377
                0.0021025830851608
                0.00138788152386034
                0.00136579556708344
                0.00150096162255807
                0.00158223794349706
                0.00161580859779794
                0.00154159978302756
                0.00137197963498098
                0.00133222491278256
                0.000948812703135587
                0.00112019972772432
                0.00154336665956971
                0.00129688738193952
                0.00121119386964515
                0.000964714592014955
                0.00116260476473597
                0.00104687435122502
                0.0014408878201249
                0.00114758631412768
                0.000874603888365206
                0.00110429783884496
                0.00087813764144951
                0.000846333863690775
                0.000853401369859383
                0.000903757351310713
                0.000938211443882676
                0.00104687435122502
                0.00111136534501357
                0.00100535275248445
                0.000931143937714068
                0.000861352314299067
                0.000934677690798372
                0.000960297400659575
                0.00108486219688129
                0.00101595401173736
                0.000917008925376853
                0.000748272215601343
                0.000798628197052673
                0.000851634493317231
                0.000866652943925523
                0.00114846975239876
                0.000950579579677739
                0.000834849166166788
                0.000947045826593436
                0.000902873913039637
                0.0011175494129111
                0.00131543958563211
                0.00122621232025344
                0.00147534191269686
                0.00138081401769173
                0.00103538965370103
                0.000658161511951595
                0.00173948995574858
                0.00163259392494839
                0.00182253315322972
                0.00162287610396655
                0.001849036301362
                0.00147534191269686
                0.00153718259167218
                0.00172977213476674
                0.00213527030119061
                0.0020840308814682
                0.00235171267760422
                0.00232520952947194
                0.00234552860970669
                0.00169001741256832
                0.00227750386283384
                0.00302312576362196
                0.00269978735640815
                0.00264854793668575
                0.00293831568959866
                0.00261586072065594
                0.00256462130093353
                0.00294891694885157
                0.00348516397939469
                0.00304167796731455
                0.00335618199181759
                0.00310881927591632
                0.0030840830043262
                0.00296216852291771
                0.00288884314641841
                0.00261851103546916
                0.00297100290562847
                0.00218739315918409
                0.00294008256614081
                0.00258229006635505
                0.00225541790605694
                0.0017129868076163
                0.00177129373350731
                0.00189232477664472
                0.00190734322725301
                0.00216177344932289
                0.00212731935675093
                0.00194533107290928
                0.00187553944949428
                0.00204604303581194
                0.00208226400492605
                0.00202307364076396
                0.00214852187525675
                0.00188967446183149
                0.00200982206669782
                0.00171387024588737
                0.00148152598059439
                0.00165467988172528
                0.00163259392494839
                0.00175185809154364
                0.00166969833233358
                0.00148064254232332
                0.00170061867182123
                0.00169973523355016
                0.00164231174593022
                0.00157252012251522
                0.00161139140644256
                0.00152216414106389
                0.00150802912872667
                0.00154248322129864
                0.00150891256699775
                0.00160962452990041
                0.00163877799284592
                0.00130572176465028
                0.0012129607461873
                0.00089138921551565
                0.00140378341273971
                0.00135519430783053
                0.00140289997446863
                0.00125271546838572
                0.00106896030800192
                0.00125183203011464
                0.00110341440057388
                0.00131367270908996
                0.00110253096230281
                0.0013967159065711
                0.00123327982642205
                0.00139141527694465
                0.00125978297455433
                0.00122621232025344
                0.00109723033267635
                0.00117320602398888
                0.00100005212285799
                0.000886088585889194
                0.000881671394533814
                0.000871953573551978
                0.000927610184629764
                0.000837499480980016
                0.000863119190841219
                0.000896689845142105
                0.000791560690884066
                0.000825131345184952
                0.000736787518077356
                0.000730603450179824
                0.000751805968685647
                0.000920542678461157
                0.000864002629112295
                0.000729720011908748
                0.000742971585974887
                0.000697916234150013
                0.000725302820553368
                0.00062194054283748
                0.000581302382367986
                0.000711167808216153
                0.000629008049006088
                0.000691732166252481
                0.000636958993445771
                0.00137197963498098
                0
                0.000573351437928302
                0.000714701561300457
                0.000829548536540332
                0.000704100302047545
                0.000515044512037288
                0.000484124172549629
                0.000543314536711719
                0.000500026061428997
                0.000576885191012606
                0.000646676814427607
                0.00047528978983887
                0.000552148919422479
                0.000489424802176085
                0.000618406789753176
                0.000433768191098299
                0.000384295647918045
                0.00036132625287007
                0.00036132625287007
                0.000295951820810449
                0.000422283493574312
                0.000375461265207286
                0.000322454968942728
                0.000359559376327918
                0.000354258746701462
                0.000258847413425258
                0.000278283055388929
                0.000221743006040067
                0.000276516178846777
                0.000180221407299497
                0.000204957678889624
                0.000188172351739181
                0.000150184506082914
                0.000131632302390319
                0.000331289351653487
                0
                0.000139583246830003
                0.000149301067811838
                0.000130748864119243
                0.000116613851782028
                0.000117497290053103
                9.89450863605082e-05
                0.00010071196290266
                9.89450863605082e-05
                0.000130748864119243
                0.000107779469071268
                0.000104245715986964
                7.7742567854685e-05
                8.83438271075966e-05
                9.27610184629764e-05
                0.000101595401173736
                9.54113332762043e-05
                0.000115730413510952
                6.71413086017734e-05
                9.01107036497485e-05
                0.000110429783884496
                8.74603888365206e-05
                7.15584999571532e-05
                9.36444567340524e-05
                8.12763209389889e-05
                6.89081851439253e-05
                8.39266357522168e-05
                2.91534629455069e-05
                0.000101595401173736
                6.97916234150013e-05
                6.18406789753176e-05
                7.7742567854685e-05
                8.39266357522168e-05
                7.59756913125331e-05
                0.000158135450522598
                0
                0.000102478839444812
                0.00010954634561342
                0.000118380728324179
                7.8626006125761e-05
                6.71413086017734e-05
                9.80616480894322e-05
                0.00010512915425804
                0.000121031043137407
                0.000121914481408483
                0.000172270462859813
                9.09941419208245e-05
                0.000145767314727534
                0.000179337969028421
                0.000119264166595255
                0.000144883876456458
                0.00014665075299861
                9.80616480894322e-05
                9.80616480894322e-05
                9.01107036497485e-05
                9.80616480894322e-05
                0.000102478839444812
                0.0001139635369688
                0.000114846975239876
                0.000102478839444812
                0.000150184506082914
                0.000104245715986964
                9.89450863605082e-05
                0.000136049493745699
                0.000121914481408483
                0.000106896030800192
                0.000145767314727534
                0.000266798357864942
                0
                0.000138699808558927
                0.000227043635666523
                0.000157252012251522
                0.000141350123372155
                9.80616480894322e-05
                0.000166969833233358
                0.000144000438185382
                0.000190822666552409
                0.000142233561643231
                0.000154601697438294
                0.000181988283841649
                0.000157252012251522
                0.000152834820896142
                0.000167853271504434
                0.000162552641877978
                0.00015990232706475
                0.000174037339401965
                0.000234994580106207
                0.000160785765335826
                0.000179337969028421
                0.000221743006040067
                0.000203190802347472
                0.00021467549987146
                0.000366626882496526
                0.000401964413339564
                0.000303902765250132
                0.000314504024503044
                0.000298602135623676
                0.000394013468899881
                0.00035690906151469
                0.000288000876370765
                0.000285350561557537
                0.000303902765250132
                0.000338356857822095
                0.000257963975154182
                0.000253546783798802
                0.00035690906151469
                0.000406381604694944
                0.000363976567683298
                0.000389596277544501
                0.000364860005954374
                0.000344540925719627
                0.000377228141749437
                0.000268565234407094
                0.000300369012165828
                0.000345424363990703
                0.000301252450436904
                0.000304786203521208
                0.000290651191183993
                0.000318921215858424
                0.000272098987491398
                0.000259730851696334
                0.000305669641792284
                0.000421400055303236
                0.00035249187015931
                0.000363976567683298
                0.000341890610906399
                0.000326872160298107
                0.000383412209646969
                0.000451436956519819
                0.000371927512122982
                0.000405498166423868
                0.00030655308006336
                0.000463805092314882
                0.00037457782693621
                0.000386062524460197
                0.00042051661703216
                0.000565400493488618
                0.000560099863862162
                0.000450553518248743
                0.000486774487362857
                0.000535363592272035
                0.000501792937971149
                0.000428467561471843
                0.000498259184886845
                0.000454087271333047
                0.000436418505911527
                0.000426700684929692
                0.000371927512122982
                0.000354258746701462
                0.000363093129412222
                0.000422283493574312
                0.000426700684929692
                0.000485891049091781
                0.000334823104737791
                0.000272982425762473
                0.000360442814598994
                0.000331289351653487
                0.000408148481237096
                0.000354258746701462
                0.000376344703478362
                0.000229693950479751
                0.000310086833147664
                0.0003198046541295
                0
                0.000119264166595255
                0.000150184506082914
                8.83438271075966e-05
                7.50922530414571e-05
                6.89081851439253e-05
                4.24050370116464e-05
                5.83069258910138e-05
                4.68222283670262e-05
                6.09572407042417e-05
                1.06012592529116e-05
                2.82700246744309e-05
                3.71044073851906e-05
                2.12025185058232e-05
                0
                1.76687654215193e-05
                1.50184506082914e-05
                7.06750616860773e-06
                0
                2.6503148132279e-06
                2.6503148132279e-06
                0
                5.3006296264558e-06
                1.76687654215193e-06
                0
                4.41719135537983e-06
                0
                6.18406789753176e-06
                1.76687654215193e-06
                0
                8.83438271075966e-07
                8.83438271075966e-07
                0
                8.83438271075966e-07
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                2.6503148132279e-06
        ]
    end

    return v
end

function distribute_vaccine(M1,M2,B)
    braks = get_breaks_vac()
    v,fd,sd = temporal_proportion()

    p2 = Distributions.Categorical(sd[1,:]/sum(sd[1,:]))
    p1 = Distributions.Categorical(fd[1,:]/sum(fd[1,:]))
    ##firstly, let's distribute age-based second doses.
    
    for i in 1:length(braks)
        #println(i)
        pos = findall(y-> y.age in braks[i],humans)

        N = sum(M2[:,i]) ##number of vaccinated
        Vaux = reverse(M2[:,i])
       
        p_day = Distributions.Categorical(Vaux/sum(Vaux))


        n1 = min(N,length(pos))
        pos_vac = sample(pos,n1,replace = false)
        
        ### distributed second dose
        for j in pos_vac
            x = humans[j]
            x.vac_status = 2
            x.vaccine_n = x.age >= 18 ? rand(p2) : 1#rand the vaccine
            x.vaccine = [:pfizer,:moderna,:jensen][x.vaccine_n]
            x.days_vac = rand(p_day) ##rand the day
            x.protected = x.days_vac > p.days_to_protection[x.vaccine_n][x.vac_status][1] ? findfirst(y-> y < x.days_vac,p.days_to_protection[x.vaccine_n][x.vac_status]) : 0
            x.index_day = min(length(p.days_to_protection[x.vaccine_n][x.vac_status]),x.protected+1)

            x.vac_eff_inf = deepcopy(p.vac_efficacy_inf[x.vaccine_n])
            x.vac_eff_symp = deepcopy(p.vac_efficacy_symp[x.vaccine_n])
            x.vac_eff_sev = deepcopy(p.vac_efficacy_sev[x.vaccine_n])

            waning_immunity(x) ##get the immunity
            
            if x.recovered
                index = Int(floor(x.days_recovered/7))

                if index > 0
                    if index <= size(waning_factors_rec,1)
                        aux = waning_factors_rec[index,1]
                    else
                        aux = waning_factors_rec[end,1]
                    end
                else
                    aux = 1.0
                end

                if aux > x.vac_eff_inf[1][x.vac_status][end]
                    x.recvac = 1
                else
                    x.recvac = 2
                end
            end
        end

        N_aux = n1

        pos = findall(y-> y.age in braks[i] && y.vac_status <= 0,humans)
        
        N = sum(M1[:,i]) ##number of vaccinated first dose
        n1 = min(N-N_aux,length(pos)) #number of first dose that didn't take second dose yet
        Vaux = reverse(M1[:,i])
        aux = findfirst(y-> y >= n1, cumsum(Vaux))

        p_day = Distributions.Categorical(Vaux[1:aux]/sum(Vaux[1:aux]))

        pos_vac = sample(pos,n1,replace = false)
        
        for j in pos_vac
            #println(j)
            x = humans[j]
            x.vac_status = 2 #let's set everybody to second dose
            
            x.vaccine_n = x.age >= 18 ? rand(p1) : 1#rand the vaccine
                
            x.vaccine = [:pfizer,:moderna,:jensen][x.vaccine_n]
            x.days_vac = 0#rand(p_day) ##rand the day
            x.protected = x.days_vac > p.days_to_protection[x.vaccine_n][x.vac_status][1] ? findfirst(y-> y < x.days_vac,p.days_to_protection[x.vaccine_n][x.vac_status]) : 0
            x.index_day = min(length(p.days_to_protection[x.vaccine_n][x.vac_status]),x.protected+1)

            x.vac_eff_inf = deepcopy(p.vac_efficacy_inf[x.vaccine_n])
            x.vac_eff_symp = deepcopy(p.vac_efficacy_symp[x.vaccine_n])
            x.vac_eff_sev = deepcopy(p.vac_efficacy_sev[x.vaccine_n])

            if x.recovered
                index = Int(floor(x.days_recovered/7))

                if index > 0
                    if index <= size(waning_factors_rec,1)
                        aux = waning_factors_rec[index,1]
                    else
                        aux = waning_factors_rec[end,1]
                    end
                else
                    aux = 1.0
                end

                if aux > x.vac_eff_inf[1][x.vac_status][end]
                    x.recvac = 1
                else
                    x.recvac = 2
                end
            end
        end
        

    end #end for age breaks
    

    ### now I want to distribute booster
    Baux = reverse(B)
    for i = 1:length(Baux)
        pos = findall(y-> y.vac_status == 2 && y.n_boosted == 0 && y.days_vac >= p.booster_after[y.vaccine_n]+(i-1) && y.age >= p.min_age_booster,humans)

        n1 = min(Baux[i],length(pos))
        pos_vac = sample(pos,n1,replace = false)
        for j in pos_vac
            x = humans[j]
            x.days_vac = (i-1) ##rand the day
            x.protected = length(p.days_to_protection[x.vaccine_n][x.vac_status])
            x.index_day = min(length(p.days_to_protection[x.vaccine_n][x.vac_status]),x.protected+1)
            x.n_boosted += 1
            x.boosted = true
            #### ADD here the new vaccine efficacy against Omicron for booster
                
            x.vac_eff_inf[6][2][end] = [0.76;0.677][x.vaccine_n]
            x.vac_eff_symp[6][2][end] = 0.82
            x.vac_eff_sev[6][2][end] = 0.90
            #moderna has a different value against Delta for booster
            x.vac_eff_inf[4][2][end] = [x.vac_eff_inf[4][2][end]; 0.94][x.vaccine_n]

            if x.recovered
                index = Int(floor(x.days_recovered/7))

                if index > 0
                    if index <= size(waning_factors_rec,1)
                        aux = waning_factors_rec[index,1]
                    else
                        aux = waning_factors_rec[end,1]
                    end
                else
                    aux = 1.0
                end

                if aux > x.vac_eff_inf[1][x.vac_status][end]
                    x.recvac = 1
                else
                    x.recvac = 2
                end
            end
        end

    end

    ## Let's boost a XX% of the population on day 0, following the order of the
    # earlier vaccinated to the later

    pos = findall(y-> y.vac_status == 2 && y.n_boosted == 0 && y.age >= p.min_age_booster,humans)

    days = [x.days_vac for x in humans[pos]]
    pos_days = sortperm(days,rev=true)
    ranpos = pos[pos_days]

    if Int(round(p.extra_booster/100*p.popsize)) > length(ranpos)
        error("not enough fully vaccinated")
    else

        for i in ranpos[1:Int(round(p.extra_booster/100*p.popsize))]
            x = humans[i]
            x.days_vac = 0 ##rand the day
            x.protected = length(p.days_to_protection[x.vaccine_n][x.vac_status])
            x.index_day = min(length(p.days_to_protection[x.vaccine_n][x.vac_status]),x.protected+1)
            x.n_boosted += 1
            x.boosted = true
            #### ADD here the new vaccine efficacy against Omicron for booster
                
            x.vac_eff_inf[6][2][end] = [0.76;0.677][x.vaccine_n]
            x.vac_eff_symp[6][2][end] = 0.82
            x.vac_eff_sev[6][2][end] = 0.90
            #moderna has a different value against Delta for booster
            x.vac_eff_inf[4][2][end] = [x.vac_eff_inf[4][2][end]; 0.94][x.vaccine_n]

            if x.recovered
                index = Int(floor(x.days_recovered/7))

                if index > 0
                    if index <= size(waning_factors_rec,1)
                        aux = waning_factors_rec[index,1]
                    else
                        aux = waning_factors_rec[end,1]
                    end
                else
                    aux = 1.0
                end

                if aux > x.vac_eff_inf[1][x.vac_status][end]
                    x.recvac = 1
                else
                    x.recvac = 2
                end
            end
        end
    end

    for x in humans
        vac_update(x)
    end

end

function _get_prob_test(x::Human,test::Int64)
    M = [
                [   0.0 0.0 0.0 0.0
                    0.009313509049	0.006866032934	0.007803657586	0.006417272611
                    0.2133219625	0.1674016942	0.1849936843	0.156460407
                    0.6245252906	0.5130620215	0.5557634429	0.4795285561
                    0.9094660428	0.7705126222	0.8237454819	0.7201523201
                    0.9945486441	0.8564832076	0.9093758818	0.8005039129
                    0.9503184103	0.8081819529	0.8626342295	0.755359603
                    0.8529628037	0.7118894356	0.7659344442	0.6653607143
                    0.7383576935	0.603564619	0.655203656	0.5641159511
                    0.6251870297	0.4994661735	0.5476296564	0.4668213255
                    0.5222683805	0.406840421	0.4510607097	0.3802495438
                    0.4327828139	0.3279132583	0.3680886373	0.3064810192
                    0.3570004322	0.262403805	0.2986436396	0.2452532295
                    0.2938391141	0.2089335229	0.2414607353	0.195277737
                    0.2417041863	0.1657670756	0.1948584758	0.1549326262
                    0.1989147335	0.1311755865	0.1571263583	0.1226020187
                    0.1639024422	0.1035960831	0.1266993644	0.09682509731
                    0.1352899444	0.08168561917	0.1022213607	0.07634668981
                    0.1119081936	0.06432400653	0.08255344156	0.06011982309
                    0.09278515497	0.05059383758	0.06675727185	0.04728705081
                    0.07712282177	0.03975252979	0.05406903601	0.03715432523
                    0.06427118563	0.03120358389	0.04387173554	0.02916413396
                    0.05370326396	0.02447025831	0.0356693816	0.02287089502
                    0.04499289969	0.01917281454	0.0290644528	0.01791968941
                    0.03779583422	0.01500948652	0.02373890423	0.01402847433
                    0.03183396993	0.01174087775	0.01943851306	0.01097350012
                    0.02688248769	0.009177324883	0.01596014782	0.008577499727
                    0.02275940604	0.007168740988	0.01314150281	0.006700195825
                    0.0193171719	0.005596489183	0.01085286341	0.005230705576
                    0.01643591315	0.004366898205	0.008990520833	0.004081480021
                    0.01401803578	0.00340609601	0.00747151519	0.003183475356
                ],
                [   0.0  0.0    0.0     0.0
                    5.94E-24	3.03E-24	4.15E-24	2.83E-24
                    0.04537575679	0.03469964287	0.03878964707	0.03243169235
                    0.5771005809	0.4739293861	0.5134541255	0.4429536092
                    0.9698884535	0.8302904859	0.8837702707	0.7760231338
                    0.9443993144	0.8022078431	0.8566811955	0.749775958
                    0.8233996036	0.6836634575	0.7371961783	0.6389795714
                    0.6858166375	0.5549744412	0.6050999023	0.5187016019
                    0.5567983372	0.4377366611	0.4833490215	0.4091264218
                    0.4457423584	0.3392709461	0.3800599942	0.3170963744
                    0.3542541276	0.2600777151	0.2961565661	0.2430791716
                    0.2806701888	0.1979565899	0.2296440531	0.1850182507
                    0.2222605315	0.1499579621	0.1776569746	0.1401567881
                    0.1762126958	0.1132199967	0.137352411	0.1058199969
                    0.1400186026	0.08527180026	0.1062452231	0.07969847998
                    0.1115847481	0.06409714608	0.08228957952	0.05990779012
                    0.08922367794	0.04810081486	0.06385492579	0.04495697076
                    0.07160155294	0.03604309054	0.0496654874	0.03368733299
                    0.05767555577	0.02697081247	0.03873375638	0.02520801427
                    0.04663514342	0.02015592802	0.03030007814	0.0188385471
                    0.03785194957	0.0150446121	0.02378207096	0.01406130412
                    0.03083908088	0.01121672029	0.018734019	0.01048360132
                    0.0252189225	0.008354156388	0.01481502453	0.007808133094
                    0.02069806833	0.00621648879	0.01176436151	0.005810182333
                    0.01704797318	0.004622278041	0.009382544347	0.004320168365
                    0.01409009342	0.003434827613	0.007516844935	0.003210329076
                    0.01168449971	0.00255132964	0.006050234228	0.002384576068
                    0.009721153956	0.001894605326	0.004892945083	0.001770774913
                    0.008113221643	0.001406825338	0.003976036317	0.00131487597
                    0.006791935941	0.001044740692	0.003246483097	0.0009764569867
                    0.005702644631	0.0007760660642	0.002663431374	0.000725342792
                ],
                [0.0    0.0     0.0     0.0
                    0.001579516574	0.001147900706	0.001313252137	0.001072874516
                    0.3515219715	0.2837658214	0.3097231071	0.2652190357
                    0.9313050383	0.7927100947	0.8458056224	0.7408989774
                    0.9472396481	0.80500906	0.859497398	0.7523940888
                    0.826809351	0.6869122607	0.740506639	0.6420160345
                    0.689613994	0.5584707646	0.6087115511	0.5219694074
                    0.5605052675	0.4410625185	0.4868208674	0.4122349029
                    0.4491261986	0.342235074	0.3831849133	0.3198667685
                    0.3572269169	0.2626191882	0.2988632759	0.2454545354
                    0.2832220522	0.2000824973	0.2319331437	0.1870052099
                    0.2244198366	0.1517068941	0.17956312	0.1417914109
                    0.1780236379	0.1146419819	0.138923405	0.1071490419
                    0.1415292607	0.0864179487	0.1075310147	0.08076971676
                    0.112841149	0.06501475526	0.08333697935	0.06076542485
                    0.09026718756	0.04883143365	0.06470541261	0.04563983668
                    0.07246804105	0.03662210908	0.05035463513	0.03422850718
                    0.058395458	0.02742778848	0.03929145906	0.02563512257
                    0.04723393372	0.02051522135	0.03075112243	0.01917435721
                    0.03835076592	0.01532610804	0.02414682205	0.01432440163
                    0.03125536897	0.01143653285	0.01902910105	0.01068904704
                    0.02556703536	0.008525265222	0.01505394336	0.007968058345
                    0.02098979537	0.006349293846	0.01195804936	0.00593430732
                    0.017292993	0.004725071876	0.009539824757	0.004416243649
                    0.01429635378	0.003514191875	0.007644822913	0.003284506131
                    0.01185853248	0.002612464756	0.006154620279	0.002441715425
                    0.009868334106	0.001941602583	0.004978322265	0.001814700454
                    0.008237978975	0.001442890037	0.004046079039	0.001348583499
                    0.006897927816	0.001072374053	0.003304135494	0.001002284245
                    0.00579289648	0.0007972126095	0.002711052064	0.0007451072101
                    0.004878778883	0.0005929083608	0.002234819322	0.0005541561804
                ]
    ] #end M
    if x.daysinf+1 > size(M[1],1)
        d = 1
        pp = [0.05 0.05 0.05 0.05]
        prob = pp[1,test]
    else
        #Let's create a Tuple with one matrix for each strain
        d = x.daysinf+1 #first row is 0
        prob = M[p.strain_test][d,test]
    end

    
    return prob
end

