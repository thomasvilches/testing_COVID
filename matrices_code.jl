


function vaccination_rate_1(sim::Int64)
    #must be written as the temporal series of vaccines per age group
    if p.prov == :ontario
        v = [0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 162 543
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 37 72
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 63 320
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 107 679
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 221 879
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 1273 741
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 1948 302
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 1302 127
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 1311 1477 1686 3614 5786 775 78
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 286 382 1077 1511 1577 329 53
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 392 517 1154 1175 1099 212 44
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 1070 1059 1143 1236 670 150 40
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 1665 1409 1100 1115 450 118 35
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 1730 1432 1104 947 272 81 27
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 1457 1134 775 606 190 61 23
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 2402 1325 974 661 396 149 43 43
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 772 796 591 429 244 107 58 40
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 515 462 322 195 138 75 51 30
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 306 364 243 158 160 70 9 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 176 272 189 125 105 59 25 10
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 123 261 179 127 110 65 27 10
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 171 239 163 113 98 60 25 9
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 145 199 139 104 91 57 26 9
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 149 168 121 91 78 49 23 9
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 99 115 85 61 51 32 14 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 89 124 90 65 55 33 15 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 91 145 101 72 59 33 14 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 89 149 103 74 56 30 12 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 93 182 118 79 58 31 12 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 98 249 154 102 72 38 15 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 73 190 135 87 64 34 13 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 75 229 150 98 71 38 16 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 64 174 119 79 59 33 14 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 52 148 110 74 56 32 13 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 42 109 82 55 44 23 9 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 41 101 80 54 41 25 10 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 32 83 64 43 34 20 9 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 27 67 52 34 27 16 7 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 26 64 51 32 25 15 9 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 25 66 49 30 25 15 8 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                571 21 54 41 26 21 14 8 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                877 0 0 59 0 0 170 187 136
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                755 14 40 37 21 13 17 10 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                473 13 40 34 19 17 23 13 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                291 3 54 44 26 17 37 26 17
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                194 11 38 25 15 13 11 5 2
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                201 10 71 48 26 20 22 11 1
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                234 15 84 57 30 25 28 14 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                167 12 82 51 25 18 21 12 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                97 8 73 43 22 13 18 11 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                56 9 68 40 19 10 14 8 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                40 8 60 31 16 8 13 10 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                20 4 47 23 10 3 12 9 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                13 1 28 16 7 2 9 7 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                8 0 20 13 7 0 8 5 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                7 0 12 12 5 0 9 6 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                7 0 6 9 5 0 8 8 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 4 11 3 0 8 7 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
        ]

    else
        error("no state set")
    end
    
    return v
end

function vaccination_rate_2(sim::Int64)
    #must be written as the temporal series of vaccines per age group
    
    
    if p.prov == :ontario
        v = [0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 109 363
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 14 39
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 9 35
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 13 58
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 11 53
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 9 38
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 13 38
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 12 16
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 231 275 299 364 283 14 23
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 7 8 10 14 20 21 19
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 9 9 10 15 21 21 16
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 10 11 14 20 26 23 15
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 33 35 38 47 46 30 16
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 117 129 132 143 99 44 21
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 142 161 165 192 299 61 36
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 23 174 188 199 261 369 354 768
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 24 341 375 405 668 1207 1439 707
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 91 737 758 817 1257 1637 1451 520
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 188 1073 1112 1379 1831 1666 1122 335
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 379 1580 1486 1470 1775 1566 820 280
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 693 1738 1514 1485 1539 1156 445 199
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 841 1415 1141 1050 1058 721 313 150
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 678 1029 824 748 752 498 268 86
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 507 676 514 458 453 319 163 48
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 307 439 330 275 265 184 83 25
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 268 390 294 236 226 155 60 20
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 227 318 230 180 168 112 42 16
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 195 268 189 150 131 80 32 13
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 153 218 144 109 92 55 23 9
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 122 292 183 130 104 58 23 9
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 95 259 172 119 99 55 22 9
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 119 366 220 149 111 57 23 10
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 113 315 186 127 94 51 21 8
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 102 270 173 117 89 48 19 8
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 85 221 147 99 72 37 14 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 80 206 145 98 74 41 17 7
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 64 177 129 86 67 37 15 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 53 132 100 63 52 29 12 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 50 120 94 63 48 27 12 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 45 114 85 55 44 25 11 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                209 35 90 70 45 36 21 10 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 77 0 0 186 212 189
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 20 65 53 31 23 22 12 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 16 57 45 25 22 23 12 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                11 0 56 42 27 17 34 24 17
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                54 12 32 22 14 12 7 3 1
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                144 3 63 45 26 20 20 10 1
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                243 7 70 51 31 24 26 13 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                294 7 73 48 26 20 19 12 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                514 13 78 48 26 16 20 12 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                414 16 90 53 27 16 17 9 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                315 14 85 45 24 15 17 11 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                227 10 68 36 18 9 16 10 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                137 6 43 25 12 7 11 8 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                106 4 33 21 11 2 10 6 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                98 2 22 17 8 3 11 7 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                106 2 12 12 7 1 10 8 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                62 0 9 14 5 1 9 7 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0        
        ]
    else
        error("no state set")
    end


    return v
end


function temporal_proportion()
    
    if p.prov == :ontario
        v = [1]
        fd = [0.78 0.22 0.0]
        sd = [0.78 0.22 0.0]

    else
       error("no distribution for proportion")
    end

    if !p.using_jj
        sd[:,3] .= 0
        fd[:,3] .= 0
    end

    return v,fd,sd
end


function get_breaks_vac()

    if p.prov == :ontario
        brak = @SVector [5:11,12:17, 18:29, 30:39, 40:49, 50:59,60:69, 70:79, 80:100]
    else
        #brak = @SVector [12:15, 16:17, 18:24, 25:39, 40:49, 50:64, 65:74, 75:100]
        error("no age breaks")
    end
    return brak
end


function waning_factor()
    M = [1	1	1	1
        0.9985	0.9972	1	1
        0.9951	0.9934	1	1
        0.9897	0.9885	0.9999	1
        0.9824	0.9825	0.9991	0.9999
        0.9733	0.9756	0.9977	0.9995
        0.9623	0.9676	0.9955	0.9989
        0.9496	0.9587	0.9927	0.998
        0.9352	0.9488	0.9891	0.9968
        0.9192	0.9381	0.9849	0.9954
        0.9016	0.9264	0.98	0.9938
        0.8827	0.9139	0.9745	0.9918
        0.8625	0.9006	0.9684	0.9897
        0.8411	0.8866	0.9616	0.9873
        0.8186	0.8718	0.9541	0.9846
        0.7951	0.8563	0.9461	0.9817
        0.7708	0.8402	0.9375	0.9785
        0.7457	0.8235	0.9284	0.9751
        0.7201	0.8063	0.9186	0.9714
        0.6939	0.7886	0.9084	0.9676
        0.6674	0.7705	0.8976	0.9634
        0.6406	0.7519	0.8864	0.9591
        0.6137	0.733	0.8747	0.9545
        0.5868	0.7138	0.8625	0.9497
        0.5599	0.6944	0.8499	0.9447
        0.5332	0.6747	0.8369	0.9394
        0.5068	0.655	0.8236	0.934
        0.4808	0.6351	0.8098	0.9283
        0.4551	0.6151	0.7958	0.9224
        0.43	0.5951	0.7815	0.9164
        0.4055	0.5752	0.7669	0.9101
        0.3816	0.5553	0.752	0.9036
        0.3585	0.5356	0.7369	0.897
        0.336	0.5159	0.7216	0.8902
        0.3144	0.4965	0.7061	0.8832
        0.2936	0.4773	0.6905	0.876
        0.2736	0.4583	0.6748	0.8686
        0.2544	0.4396	0.659	0.8611
        0.2362	0.4213	0.643	0.8535
        0.2188	0.4032	0.6271	0.8456
        0.2023	0.3855	0.6111	0.8377
        0.1867	0.3682	0.5951	0.8296
        0.1719	0.3513	0.5791	0.8213
        0.158	0.3348	0.5631	0.813
        0.1449	0.3187	0.5473	0.8045
        0.1327	0.3031	0.5314	0.7959
        0.1212	0.2879	0.5157	0.7872
        0.1105	0.2732	0.5001	0.7783
        0.1006	0.259	0.4847	0.7694
        0.0914	0.2452	0.4693	0.7604
        0.0828	0.2319	0.4542	0.7513
        0.0749	0.2192	0.4392	0.7421
        0.0677	0.2068	0.4245	0.7328
        0.061	0.195	0.4099	0.7235
        0.0548	0.1837	0.3956	0.7141
        0.0492	0.1728	0.3815	0.7046
        0.0441	0.1624	0.3676	0.6951
        0.0394	0.1524	0.3541	0.6855
        0.0352	0.1429	0.3407	0.6759
        0.0313	0.1339	0.3277	0.6662
        0.0278	0.1253	0.3149	0.6565
        0.0247	0.1171	0.3024	0.6468
        0.0219	0.1093	0.2902	0.6371
        0.0193	0.102	0.2783	0.6273
        0.017	0.095	0.2667	0.6176
        0.015	0.0884	0.2554	0.6078
        0.0132	0.0822	0.2445	0.598
        0.0115	0.0763	0.2338	0.5883
        0.0101	0.0708	0.2234	0.5785
        0.0088	0.0656	0.2134	0.5688
        0.0077	0.0607	0.2036	0.559
        0.0067	0.0562	0.1942	0.5493
        0.0058	0.0519	0.1851	0.5397
        0.005	0.0479	0.1763	0.53
        0.0043	0.0441	0.1677	0.5204
        0.0037	0.0406	0.1595	0.5109
        0.0032	0.0374	0.1516	0.5013
        0.0028	0.0343	0.144	0.4919
        0.0024	0.0315	0.1367	0.4825
        0.002	0.0289	0.1296	0.4731
        0.0017	0.0264	0.1228	0.4638
        0.0015	0.0242	0.1163	0.4546
        0.0013	0.0221	0.1101	0.4454
        0.0011	0.0202	0.1041	0.4363
        0.0009	0.0184	0.0984	0.4273
        0.0008	0.0168	0.0929	0.4184
        0.0006	0.0152	0.0877	0.4095
        0.0005	0.0139	0.0827	0.4008
        0.0005	0.0126	0.078	0.3921
        0.0004	0.0114	0.0734	0.3835
        0.0003	0.0103	0.0691	0.375
        0.0003	0.0093	0.065	0.3666
        0.0002	0.0085	0.0611	0.3582
        0.0002	0.0076	0.0574	0.35
        0.0002	0.0069	0.0538	0.3419
        0.0001	0.0062	0.0505	0.3339
        0.0001	0.0056	0.0473	0.326
        0.0001	0.005	0.0443	0.3182
        0.0001	0.0045	0.0415	0.3104
        0.0001	0.004	0.0388	0.3029
    ]

    return M
end


function booster_doses()

    if p.prov == :ontario
        v = [  0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                7457
                0
                0
                0
                0
                0
                0
                5007
                0
                0
                0
                0
                0
                0
                7052
                0
                0
                0
                0
                0
                0
                5329
                0
                0
                0
                0
                0
                0
                6756
                0
                0
                0
                0
                0
                0
                5729
                0
                0
                0
                0
                0
                0
                3391
                0
                0
                0
                0
                0
                0
                0
                2279
                0
                0
                0
                0
                0
                0
                1504
                0
                0
                0
                0
                0
                0
                1022
                0
                0
                0
                0
                0
                0
                863
                0
                0
                0
                0
                0
                0
                615
                0
                0
                0
                0
                0
                0
                406
                0
                0
                0
                0
                0
                0
                325
                0
                0
                0
                0
                0
                0
                292
                0
                0
                0
                0
                0
                0
                208
                0
                0
                0
                0
        ]
    end

    
    return v
end

function vector_probs()
    #this must be written as the reverse vector of incidence
    if p.prov == :ontario
        v = [0.00269996189604588
                0.00242041821455021
                0.00138481639140932
                0.00149749399841219
                0.00190519770619357
                0.00236881015027408
                0.0023748310911063
                0.00220280421018588
                0.00184842883548983
                0.00124461448345919
                0.00104678357040071
                0.00144502579973147
                0.00178735929276309
                0.00215205628031436
                0.00206260230223575
                0.00172973028765475
                0.00092550461935182
                0.000959909995535902
                0.00140287921390596
                0.00173317082527316
                0.00183208628180239
                0.00182778560977938
                0.00167468168576022
                0.00103904236075929
                0.000923784350542616
                0.00153706018102389
                0.00166005940088198
                0.0017933802335953
                0.00194562402320987
                0.00168500329861544
                0.00101151805981203
                0.00113107674205171
                0.00172112894360873
                0.00201099423795962
                0.00208754619996921
                0.00206776310866336
                0.00122569152655794
                0.00110269230669984
                0.00114827943014375
                0.00169102423944766
                0.00193014160392703
                0.00201013410355502
                0.002001532759509
                0.00217786031245242
                0.00137019410653109
                0.00151813722412264
                0.00194820442642367
                0.00253223568714847
                0.0025004107141782
                0.0027532902291312
                0.00271974498735172
                0.00179940117442752
                0.00179596063680911
                0.00248320802608616
                0.00275587063234501
                0.00348096393542455
                0.00352483079005925
                0.00336226538758946
                0.00225527240886661
                0.00261738899320408
                0.00340613224222417
                0.00417595253434302
                0.00459053731736121
                0.00503350653573127
                0.00461720148390387
                0.00294510020135746
                0.00412004379804388
                0.00501716398204383
                0.00556765000098915
                0.00616286300897378
                0.0066720625764982
                0.00494061202003425
                0.00609491239101022
                0.00732920526161418
                0.00898840452809156
                0.00923096243018934
                0.00943051361205702
                0.00852307181520184
                0.00841469488022198
                0.006838928650991
                0.00834846453106762
                0.0102863473446361
                0.0114931159142928
                0.0102347392803599
                0.0114733328229869
                0.00996207667410109
                0.00976424576104262
                0.0116789049456868
                0.0143762864385189
                0.0158651790928851
                0.0143754263041143
                0.0118758757243407
                0.00897636264642713
                0.00759068612061321
                0.00810074582254223
                0.00845168065961987
                0.00895571942071668
                0.00823234638644635
                0.00498017820264595
                0.00376996909537084
                0.00297004409909092
                0.00325474858701421
                0.00359278140802282
                0.00283930366959141
                0.00268705987997685
                0.00208238539354159
                0.00155512300352053
                0.00122913206417635
                0.00132116644546877
                0.00126955838119265
                0.00138223598819552
                0.0012497752898868
                0.00110957338193666
                0.000867875614243482
                0.000798204727470715
                0.00076293921688203
                0.00101839913504884
                0.000905721528045972
                0.000886798571144727
                0.000824868894013378
                0.000670904835589609
                0.000590912335961617
                0.000677785910826426
                0.000829169566036389
                0.000734554781530162
                0.000797344593066112
                0.000643380534642343
                0.000508339433119819
                0.000527262390021065
                0.000539304271685494
                0.000637359593810129
                0.000626177846550302
                0.000682086582849436
                0.000611555561672067
                0.000440388815156256
                0.000413724648613592
                0.000474794191340339
                0.000572849513464974
                0.000568548841441964
                0.000514360373952034
                0.000552206287754524
                0.000390501019689337
                0.00037931927242951
                0.00041286451420899
                0.000547045481326912
                0.000436948277537848
                0.000484255669790962
                0.000376738869215704
                0.00032513080493958
                0.000284704487923283
                0.000362976718742071
                0.000292445697564701
                0.000306207848038334
                0.000360396315528264
                0.000351794971482244
                0.000276103143877262
                0.000231376154837955
                0.000280403815900273
                0.000318249729702763
                0.00032083013291657
                0.000423186127064215
                0.000355235509100652
                0.000261480858999027
                0.000282124084709477
                0.00032083013291657
                0.000381039541238714
                0.000418025320636603
                0.000426626664682623
                0.00035867604671906
                0.000263201127808231
                0.000335452417794805
                0.000393941557307745
                0.000460171906462104
                0.000562527900609749
                0.000492857013836982
                0.000504898895501411
                0.000409423976590582
                0.000368997659574285
                0.000439528680751654
                0.000498877954669197
                0.000605534620839852
                0.000574569782274178
                0.000556506959777535
                0.000425766530278021
                0.000400822632544561
                0.000527262390021065
                0.000561667766205147
                0.00055048601894532
                0.0006253177121457
                0.000582310991915597
                0.000398242229330755
                0.000493717148241584
                0.000524681986807258
                0.000614996099290475
                0.000706170346178294
                0.00068380685165864
                0.000743156125576183
                0.000510059701929023
                0.00049629755145539
                0.000516080642761238
                0.000674345373208017
                0.000737135184743968
                0.00072939397510255
                0.000686387254872446
                0.000476514460149543
                0.000485115804195564
                0.000499738089073799
                0.000697569002132273
                0.000811966877944348
                0.000694128464513865
                0.000744016259980785
                0.000564248169418953
                0.000451570562416083
                0.000596933276793832
                0.000636499459405527
                0.000718212227842723
                0.000671764969994211
                0.000583171126320199
                0.000567688707037362
                0.000418025320636603
                0.000549625884540718
                0.00062101704012269
                0.000592632604770821
                0.000559087362991341
                0.000456731368843696
                0.000417165186232001
                0.000299326772801518
                0.000452430696820685
                0.000439528680751654
                0.000497157685859993
                0.000438668546347052
                0.000441248949560858
                0.000278683547091068
                0.000276103143877262
                0.00027954368149567
                0.000363836853146673
                0.00032513080493958
                0.000292445697564701
                0.000183208628180239
                0.000119558682239687
                0.000141062042354738
                0.000144502579973147
                0.00018750930020325
                0.000221914676387332
                0.000194390375440066
                0.00018750930020325
                0.000135901235927126
                0.000110957338193666
                0.000102355994147646
                0.000147943117591555
                0.000146222848782351
                0.000165145805683596
                0.000159124864851382
                0.000116118144621279
                0.000109237069384462
                0.000111817472598268
                0.000152243789614565
                0.000151383655209963
                0.000136761370331728
                0.000122999219858095
                0.000131600563904116
                0.000125579623071901
                9.80553221246352e-05
                0.000142782311163942
                0.000153964058423769
                0.000157404596042178
                0.000180628224966433
                0.0001668660744928
                0.000209872794722903
                0.000146222848782351
                0.000183208628180239
                0.000179768090561831
                0.000172026880920413
                0.000244278170906986
                0.00015826473044678
                0.000257180186976017
                0.000180628224966433
                0.000246858574120792
                0.000297606503992314
                0.000220194407578128
                0.000254599783762211
                0.000219334273173526
                0.000254599783762211
                0.000232236289242557
                0.000273522740663456
                0.000305347713633732
                0.000296746369587712
                0.000318249729702763
                0.000330291611367192
                0.000254599783762211
                0.000384480078857122
                0.000455871234439093
                0.000431787471110236
                0.000493717148241584
                0.000507479298715217
                0.000353515240291448
                0.000403403035758368
                0.000451570562416083
                0.000570269110251168
                0.000639939997023935
                0.000786162845806286
                0.000748316932003795
                0.000630478518573312
                0.000601233948816842
                0.00078788311461549
                0.000888518839953931
                0.000909162065664381
                0.00109495109705843
                0.000976252549223342
                0.000941847173039259
                0.000893679646381544
                0.00124375434905458
                0.00145448727818209
                0.0015430811218561
                0.0016256540246979
                0.00206432257104495
                0.00136589343450808
                0.00138997719783693
                0.00186649165798648
                0.00189143555571994
                0.00222258730149173
                0.00203163746367007
                0.00237311082229709
                0.00199551181867679
                0.00178305862074008
                0.0023361250428992
                0.00276619224520023
                0.00246342493478031
                0.00272318552497013
                0.00294510020135746
                0.00252965528393467
                0.00240063512324436
                0.00295542181421269
                0.0032100215979749
                0.00289779280910435
                0.00334334243068822
                0.00332958028021459
                0.00299326772801518
                0.00280833883102574
                0.00301907176015324
                0.00339495049496434
                0.00352139025244085
                0.00387490549273229
                0.0031670148777448
                0.00362288611218389
                0.00298380624956456
                0.00382501769726537
                0.00365557121955877
                0.0037519062728742
                0.00413896675494513
                0.00407359654019537
                0.00357471858552617
                0.00315669326488957
                0.00378545151465368
                0.00383275890690679
                0.00327969248474767
                0.00363578812825292
                0.0028341428631638
                0.00276533211079563
                0.00263631195010532
                0.00252707488072086
                0.00261566872439487
                0.00258814442344761
                0.00265695517581577
                0.00219936367256748
                0.00200669356593661
                0.00200927396915042
                0.00180112144323672
                0.00210560902246585
                0.00210990969448886
                0.00186563152358187
                0.00204711988295291
                0.00135127114962984
                0.00132976778951479
                0.00146136835341891
                0.00154050071864229
                0.00157318582601717
                0.0015009345360306
                0.001335788730347
                0.00129708268213991
                0.000923784350542616
                0.00109065042503542
                0.0015026548048398
                0.00126267730595583
                0.00117924426870943
                0.000939266769825453
                0.00113193687645632
                0.00101925926945344
                0.00140287921390596
                0.00111731459157808
                0.000851533060556043
                0.00107516800575258
                0.000854973598174451
                0.000824008759608776
                0.000830889834845593
                0.000879917495907911
                0.000913462737687391
                0.00101925926945344
                0.0010820490809894
                0.000978832952437148
                0.000906581662450574
                0.000838631044487012
                0.000910022200068983
                0.000934966097802443
                0.00105624504885133
                0.000989154565292372
                0.000892819511976942
                0.000728533840697947
                0.000777561501760265
                0.000829169566036389
                0.000843791850914624
                0.00111817472598268
                0.00092550461935182
                0.00081282701234895
                0.000922064081733412
                0.000879057361503309
                0.00108807002182161
                0.00128074012845247
                0.00119386655358766
                0.00143642445568545
                0.00134439007439302
                0.00100807752219362
                0.000640800131428537
                0.00169360464266146
                0.00158952837970461
                0.00177445727669406
                0.00158006690125399
                0.00180026130883212
                0.00143642445568545
                0.00149663386400759
                0.00168414316421084
                0.00207894485592319
                0.00202905706045627
                0.00228967778505069
                0.00226387375291263
                0.00228365684421848
                0.00164543711600375
                0.00221742649506412
                0.00294337993254826
                0.0026285707404639
                0.00257868294499699
                0.00286080702970646
                0.00254685797202671
                0.00249697017655979
                0.00287112864256169
                0.00339323022615514
                0.0029614427550449
                0.00326765060308324
                0.00302681296979466
                0.0030027292064658
                0.00288403065863072
                0.00281263950304875
                0.00254943837524052
                0.00289263200267674
                0.00212969278579471
                0.00286252729851567
                0.00251417286465183
                0.00219592313494907
                0.0016678006105234
                0.00172456948122714
                0.00184240789465762
                0.00185703017953585
                0.00210474888806125
                0.00207120364628177
                0.00189401595893374
                0.00182606534097018
                0.00199207128105838
                0.00202733679164706
                0.00196970778653872
                0.00209184687199222
                0.00183982749144381
                0.00195680577046969
                0.001668660744928
                0.00144244539651766
                0.00161103173981966
                0.00158952837970461
                0.00170564652432589
                0.0016256540246979
                0.00144158526211306
                0.00165575872885897
                0.00165489859445437
                0.00159898985815524
                0.00153103924019167
                0.00156888515399416
                0.00148201157912935
                0.00146824942865572
                0.0015017946704352
                0.00146910956306032
                0.00156716488518496
                0.00159554932053683
                0.00127127865000185
                0.00118096453751863
                0.000867875614243482
                0.00136675356891268
                0.00131944617665956
                0.00136589343450808
                0.00121967058572573
                0.0010407626295685
                0.00121881045132112
                0.00107430787134798
                0.00127901985964327
                0.00107344773694337
                0.00135987249367586
                0.00120074762882448
                0.00135471168724825
                0.00122655166096254
                0.00119386655358766
                0.00106828693051576
                0.00114225848931154
                0.000973672146009535
                0.000862714807815869
                0.000858414135792859
                0.000848952657342236
                0.000903141124832166
                0.000815407415562756
                0.000840351313296216
                0.000873036420671094
                0.000770680426523449
                0.000803365533898327
                0.000717352093438121
                0.000711331152605906
                0.000731974378316356
                0.00089626004959535
                0.000841211447700818
                0.000710471018201304
                0.000723373034270335
                0.00067950617963563
                0.000706170346178294
                0.000605534620839852
                0.000565968438228158
                0.000692408195704661
                0.000612415696076669
                0.000673485238803415
                0.000620156905718088
                0.001335788730347
                0
                0.000558227228586739
                0.000695848733323069
                0.000807666205921337
                0.000685527120467844
                0.000501458357883003
                0.000471353653721931
                0.000528982658830269
                0.000486836073004768
                0.000561667766205147
                0.00062961838416871
                0.00046275230967591
                0.000537584002876289
                0.000476514460149543
                0.000602094083221444
                0.000422325992659613
                0.000374158466001897
                0.000351794971482244
                0.000351794971482244
                0.000288145025541691
                0.000411144245399786
                0.000365557121955877
                0.000313949057679753
                0.00035007470267304
                0.000344913896245427
                0.000252019380548405
                0.00027094233744965
                0.000215893735555118
                0.000269222068640446
                0.000175467418538821
                0.000199551181867679
                0.000183208628180239
                0.000146222848782351
                0.000128160026285707
                0.000322550401725774
                0
                0.000135901235927126
                0.000145362714377749
                0.000127299891881105
                0.000113537741407472
                0.000114397875812074
                9.63350533154311e-05
                9.80553221246352e-05
                9.63350533154311e-05
                0.000127299891881105
                0.000104936397361452
                0.000101495859743043
                7.56918276049816e-05
                8.60134404602063e-05
                9.03141124832166e-05
                9.89154565292373e-05
                9.28945156970228e-05
                0.00011267760700287
                6.53702147497568e-05
                8.77337092694104e-05
                0.000107516800575258
                8.51533060556042e-05
                6.96708867727671e-05
                9.11742468878187e-05
                7.91323652233898e-05
                6.70904835589609e-05
                8.1712768437196e-05
                2.83844353518681e-05
                9.89154565292373e-05
                6.7950617963563e-05
                6.02094083221444e-05
                7.56918276049816e-05
                8.1712768437196e-05
                7.39715587957774e-05
                0.000153964058423769
                0
                9.97755909338393e-05
                0.000106656666170656
                0.000115258010216676
                7.65519620095836e-05
                6.53702147497568e-05
                9.5474918910829e-05
                0.000102355994147646
                0.000117838413430483
                0.000118698547835085
                0.000167726208897402
                8.85938436740125e-05
                0.00014192217675934
                0.000174607284134219
                0.000116118144621279
                0.000141062042354738
                0.000142782311163942
                9.5474918910829e-05
                9.5474918910829e-05
                8.77337092694104e-05
                9.5474918910829e-05
                9.97755909338393e-05
                0.000110957338193666
                0.000111817472598268
                9.97755909338393e-05
                0.000146222848782351
                0.000101495859743043
                9.63350533154311e-05
                0.000132460698308718
                0.000118698547835085
                0.00010407626295685
                0.00014192217675934
                0.000259760590189823
                0
                0.000135041101522524
                0.00022105454198273
                0.000153103924019167
                0.00013762150473633
                9.5474918910829e-05
                0.00016256540246979
                0.000140201907950136
                0.000185789031394046
                0.000138481639140932
                0.000150523520805361
                0.000177187687348025
                0.000153103924019167
                0.000148803251996157
                0.000163425536874392
                0.00015826473044678
                0.000155684327232973
                0.000169446477706606
                0.000228795751624149
                0.000156544461637575
                0.000174607284134219
                0.000215893735555118
                0.000197830913058475
                0.000209012660318301
                0.000356955777909856
                0.000391361154093939
                0.00029588623518311
                0.000306207848038334
                0.000290725428755497
                0.00038361994445252
                0.000347494299459234
                0.000280403815900273
                0.000277823412686466
                0.00029588623518311
                0.00032943147696259
                0.000251159246143802
                0.000246858574120792
                0.000347494299459234
                0.000395661826116949
                0.00035437537469605
                0.00037931927242951
                0.000355235509100652
                0.000335452417794805
                0.000367277390765081
                0.000261480858999027
                0.000292445697564701
                0.000336312552199407
                0.000293305831969304
                0.000296746369587712
                0.000282984219114079
                0.000310508520061345
                0.000264921396617435
                0.000252879514953007
                0.000297606503992314
                0.000410284110995184
                0.000343193627436223
                0.00035437537469605
                0.000332872014580998
                0.000318249729702763
                0.000373298331597295
                0.000439528680751654
                0.000362116584337469
                0.000394801691712347
                0.000298466638396916
                0.000451570562416083
                0.000364696987551275
                0.000375878734811102
                0.000409423976590582
                0.00055048601894532
                0.000545325212517708
                0.000438668546347052
                0.000473934056935737
                0.00052124144918885
                0.000488556341813972
                0.000417165186232001
                0.000485115804195564
                0.00044210908396546
                0.000424906395873419
                0.000415444917422796
                0.000362116584337469
                0.000344913896245427
                0.000353515240291448
                0.000411144245399786
                0.000415444917422796
                0.000473073922531135
                0.000325990939344182
                0.000265781531022038
                0.000350934837077642
                0.000322550401725774
                0.000397382094926153
                0.000344913896245427
                0.000366417256360479
                0.000223634945196536
                0.000301907176015324
                0.000311368654465947
                0
                0.000116118144621279
                0.000146222848782351
                8.60134404602063e-05
                7.31114243911754e-05
                6.70904835589609e-05
                4.1286451420899e-05
                5.67688707037362e-05
                4.55871234439093e-05
                5.93492739175424e-05
                1.03216128552248e-05
                2.7524300947266e-05
                3.61256449932866e-05
                2.06432257104495e-05
                0
                1.72026880920413e-05
                1.46222848782351e-05
                6.8810752368165e-06
                0
                2.58040321380619e-06
                2.58040321380619e-06
                0
                5.16080642761238e-06
                1.72026880920413e-06
                0
                4.30067202301032e-06
                0
                6.02094083221444e-06
                1.72026880920413e-06
                0
                8.60134404602063e-07
                8.60134404602063e-07
                0
                8.60134404602063e-07
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                2.58040321380619e-06                
        ]
    end

    return v
end

function distribute_vaccine(M1,M2,B,sim)
    braks = get_breaks_vac()
    v,fd,sd = temporal_proportion()

    p2 = Distributions.Categorical(sd[1,:]/sum(sd[1,:]))
    p1 = Distributions.Categorical(fd[1,:]/sum(fd[1,:]))
    ##firstly, let's distribute age-based second doses.
    
    for i in 1:length(braks)
        #println(i)
        pos = findall(y-> y.age in braks[i],humans)

        N = sum(M2[:,i]) ##number of vaccinated
        Vaux = reverse(M2[:,i])
       
        p_day = Distributions.Categorical(Vaux/sum(Vaux))


        n1 = min(N,length(pos))
        pos_vac = sample(pos,n1,replace = false)
        
        ### distributed second dose
        for j in pos_vac
            x = humans[j]
            x.vac_status = 2
            x.vaccine_n = x.age >= 18 ? rand(p2) : 1#rand the vaccine
            x.vaccine = [:pfizer,:moderna,:jensen][x.vaccine_n]
            x.days_vac = rand(p_day) ##rand the day
            x.protected = x.days_vac > p.days_to_protection[x.vaccine_n][x.vac_status][1] ? findfirst(y-> y < x.days_vac,p.days_to_protection[x.vaccine_n][x.vac_status]) : 0
            x.index_day = min(length(p.days_to_protection[x.vaccine_n][x.vac_status]),x.protected+1)

            x.vac_eff_inf = deepcopy(p.vac_efficacy_inf[x.vaccine_n])
            x.vac_eff_symp = deepcopy(p.vac_efficacy_symp[x.vaccine_n])
            x.vac_eff_sev = deepcopy(p.vac_efficacy_sev[x.vaccine_n])

            waning_immunity(x) ##get the immunity
            
            if x.recovered
                index = Int(floor(x.days_recovered/7))

                if index > 0
                    if index <= size(waning_factors_rec,1)
                        aux = waning_factors_rec[index,1]
                    else
                        aux = waning_factors_rec[end,1]
                    end
                else
                    aux = 1.0
                end

                if aux > x.vac_eff_inf[1][x.vac_status][end]
                    x.recvac = 1
                else
                    x.recvac = 2
                end
            end
        end

        N_aux = n1

        pos = findall(y-> y.age in braks[i] && y.vac_status <= 0,humans)
        
        N = sum(M1[:,i]) ##number of vaccinated first dose
        n1 = min(N-N_aux,length(pos)) #number of first dose that didn't take second dose yet
        Vaux = reverse(M1[:,i])
        aux = findfirst(y-> y >= n1, cumsum(Vaux))

        p_day = Distributions.Categorical(Vaux[1:aux]/sum(Vaux[1:aux]))

        pos_vac = sample(pos,n1,replace = false)
        
        for j in pos_vac
            #println(j)
            x = humans[j]
            x.vac_status = 2 #let's set everybody to second dose
            
            x.vaccine_n = x.age >= 18 ? rand(p1) : 1#rand the vaccine
                
            x.vaccine = [:pfizer,:moderna,:jensen][x.vaccine_n]
            x.days_vac = 0#rand(p_day) ##rand the day
            x.protected = x.days_vac > p.days_to_protection[x.vaccine_n][x.vac_status][1] ? findfirst(y-> y < x.days_vac,p.days_to_protection[x.vaccine_n][x.vac_status]) : 0
            x.index_day = min(length(p.days_to_protection[x.vaccine_n][x.vac_status]),x.protected+1)

            x.vac_eff_inf = deepcopy(p.vac_efficacy_inf[x.vaccine_n])
            x.vac_eff_symp = deepcopy(p.vac_efficacy_symp[x.vaccine_n])
            x.vac_eff_sev = deepcopy(p.vac_efficacy_sev[x.vaccine_n])

            if x.recovered
                index = Int(floor(x.days_recovered/7))

                if index > 0
                    if index <= size(waning_factors_rec,1)
                        aux = waning_factors_rec[index,1]
                    else
                        aux = waning_factors_rec[end,1]
                    end
                else
                    aux = 1.0
                end

                if aux > x.vac_eff_inf[1][x.vac_status][end]
                    x.recvac = 1
                else
                    x.recvac = 2
                end
            end
        end
        

    end #end for age breaks
    

    ### now I want to distribute booster
    Baux = reverse(B)
    for i = 1:length(Baux)
        pos = findall(y-> y.vac_status == 2 && y.n_boosted == 0 && y.days_vac >= p.booster_after[y.vaccine_n]+(i-1) && y.age >= p.min_age_booster,humans)

        n1 = min(Baux[i],length(pos))
        pos_vac = sample(pos,n1,replace = false)
        for j in pos_vac
            x = humans[j]
            x.days_vac = (i-1) ##rand the day
            x.protected = length(p.days_to_protection[x.vaccine_n][x.vac_status])
            x.index_day = min(length(p.days_to_protection[x.vaccine_n][x.vac_status]),x.protected+1)
            x.n_boosted += 1
            x.boosted = true
            #### ADD here the new vaccine efficacy against Omicron for booster
                
            x.vac_eff_inf[3][2][end] = [0.76;0.677][x.vaccine_n]
            x.vac_eff_symp[3][2][end] = 0.82
            x.vac_eff_sev[3][2][end] = 0.90
            #moderna has a different value against Delta for booster
            x.vac_eff_inf[2][2][end] = [x.vac_eff_inf[2][2][end]; 0.94][x.vaccine_n]

            if x.recovered
                index = Int(floor(x.days_recovered/7))

                if index > 0
                    if index <= size(waning_factors_rec,1)
                        aux = waning_factors_rec[index,1]
                    else
                        aux = waning_factors_rec[end,1]
                    end
                else
                    aux = 1.0
                end

                if aux > x.vac_eff_inf[1][x.vac_status][end]
                    x.recvac = 1
                else
                    x.recvac = 2
                end
            end
        end

    end

    ## Let's boost a XX% of the working-age population on day 0, following the order of the
    # earlier vaccinated to the later

    ## Let's find the number of boosted people
    pos = findall(y-> y.n_boosted == 1 && y.age in 18:65,humans)
    NN = Int(round(length(pos)*(p.extra_booster/100))) # This is the number of extra booster we want to give

    ##Let's find everybody who can be boosted
    pos = findall(y-> y.vac_status == 2 && y.age in 18:65 && y.n_boosted == 0,humans)

    days = [x.days_vac for x in humans[pos]]
    pos_days = sortperm(days,rev=true)
    ranpos = pos[pos_days]

    rng = MersenneTwister(200*sim)
    NN = min(NN,length(ranpos)) ## making sure we are capping the boosters

    max_b = length(B)-findfirst(yy-> yy > 0, B)

    for i in ranpos[1:NN]
        x = humans[i]
        dd = max(0,min((x.days_vac-p.booster_after[x.vaccine_n]),max_b))
        x.days_vac = rand(rng,0:dd) ##rand the day
        x.protected = length(p.days_to_protection[x.vaccine_n][x.vac_status])
        x.index_day = min(length(p.days_to_protection[x.vaccine_n][x.vac_status]),x.protected+1)
        x.n_boosted += 1
        x.boosted = true
        #### ADD here the new vaccine efficacy against Omicron for booster
            
        x.vac_eff_inf[3][2][end] = [0.76;0.677][x.vaccine_n]
        x.vac_eff_symp[3][2][end] = 0.82
        x.vac_eff_sev[3][2][end] = 0.90
        #moderna has a different value against Delta for booster
        x.vac_eff_inf[2][2][end] = [x.vac_eff_inf[2][2][end]; 0.94][x.vaccine_n]

        if x.recovered
            index = Int(floor(x.days_recovered/7))

            if index > 0
                if index <= size(waning_factors_rec,1)
                    aux = waning_factors_rec[index,1]
                else
                    aux = waning_factors_rec[end,1]
                end
            else
                aux = 1.0
            end

            if aux > x.vac_eff_inf[1][x.vac_status][end]
                x.recvac = 1
            else
                x.recvac = 2
            end
        end
    end
  

    for x in humans
        vac_update(x)
    end

end

function _get_prob_test(x::Human,test::Int64)
    M = [
                [   0.0 0.0 0.0 0.0
                    0.009313509049	0.006866032934	0.007803657586	0.006417272611
                    0.2133219625	0.1674016942	0.1849936843	0.156460407
                    0.6245252906	0.5130620215	0.5557634429	0.4795285561
                    0.9094660428	0.7705126222	0.8237454819	0.7201523201
                    0.9945486441	0.8564832076	0.9093758818	0.8005039129
                    0.9503184103	0.8081819529	0.8626342295	0.755359603
                    0.8529628037	0.7118894356	0.7659344442	0.6653607143
                    0.7383576935	0.603564619	0.655203656	0.5641159511
                    0.6251870297	0.4994661735	0.5476296564	0.4668213255
                    0.5222683805	0.406840421	0.4510607097	0.3802495438
                    0.4327828139	0.3279132583	0.3680886373	0.3064810192
                    0.3570004322	0.262403805	0.2986436396	0.2452532295
                    0.2938391141	0.2089335229	0.2414607353	0.195277737
                    0.2417041863	0.1657670756	0.1948584758	0.1549326262
                    0.1989147335	0.1311755865	0.1571263583	0.1226020187
                    0.1639024422	0.1035960831	0.1266993644	0.09682509731
                    0.1352899444	0.08168561917	0.1022213607	0.07634668981
                    0.1119081936	0.06432400653	0.08255344156	0.06011982309
                    0.09278515497	0.05059383758	0.06675727185	0.04728705081
                    0.07712282177	0.03975252979	0.05406903601	0.03715432523
                    0.06427118563	0.03120358389	0.04387173554	0.02916413396
                    0.05370326396	0.02447025831	0.0356693816	0.02287089502
                    0.04499289969	0.01917281454	0.0290644528	0.01791968941
                    0.03779583422	0.01500948652	0.02373890423	0.01402847433
                    0.03183396993	0.01174087775	0.01943851306	0.01097350012
                    0.02688248769	0.009177324883	0.01596014782	0.008577499727
                    0.02275940604	0.007168740988	0.01314150281	0.006700195825
                    0.0193171719	0.005596489183	0.01085286341	0.005230705576
                    0.01643591315	0.004366898205	0.008990520833	0.004081480021
                    0.01401803578	0.00340609601	0.00747151519	0.003183475356
                ],
                [   0.0  0.0    0.0     0.0
                    5.94E-24	3.03E-24	4.15E-24	2.83E-24
                    0.04537575679	0.03469964287	0.03878964707	0.03243169235
                    0.5771005809	0.4739293861	0.5134541255	0.4429536092
                    0.9698884535	0.8302904859	0.8837702707	0.7760231338
                    0.9443993144	0.8022078431	0.8566811955	0.749775958
                    0.8233996036	0.6836634575	0.7371961783	0.6389795714
                    0.6858166375	0.5549744412	0.6050999023	0.5187016019
                    0.5567983372	0.4377366611	0.4833490215	0.4091264218
                    0.4457423584	0.3392709461	0.3800599942	0.3170963744
                    0.3542541276	0.2600777151	0.2961565661	0.2430791716
                    0.2806701888	0.1979565899	0.2296440531	0.1850182507
                    0.2222605315	0.1499579621	0.1776569746	0.1401567881
                    0.1762126958	0.1132199967	0.137352411	0.1058199969
                    0.1400186026	0.08527180026	0.1062452231	0.07969847998
                    0.1115847481	0.06409714608	0.08228957952	0.05990779012
                    0.08922367794	0.04810081486	0.06385492579	0.04495697076
                    0.07160155294	0.03604309054	0.0496654874	0.03368733299
                    0.05767555577	0.02697081247	0.03873375638	0.02520801427
                    0.04663514342	0.02015592802	0.03030007814	0.0188385471
                    0.03785194957	0.0150446121	0.02378207096	0.01406130412
                    0.03083908088	0.01121672029	0.018734019	0.01048360132
                    0.0252189225	0.008354156388	0.01481502453	0.007808133094
                    0.02069806833	0.00621648879	0.01176436151	0.005810182333
                    0.01704797318	0.004622278041	0.009382544347	0.004320168365
                    0.01409009342	0.003434827613	0.007516844935	0.003210329076
                    0.01168449971	0.00255132964	0.006050234228	0.002384576068
                    0.009721153956	0.001894605326	0.004892945083	0.001770774913
                    0.008113221643	0.001406825338	0.003976036317	0.00131487597
                    0.006791935941	0.001044740692	0.003246483097	0.0009764569867
                    0.005702644631	0.0007760660642	0.002663431374	0.000725342792
                ],
                [0.0    0.0     0.0     0.0
                    0.001579516574	0.001147900706	0.001313252137	0.001072874516
                    0.3515219715	0.2837658214	0.3097231071	0.2652190357
                    0.9313050383	0.7927100947	0.8458056224	0.7408989774
                    0.9472396481	0.80500906	0.859497398	0.7523940888
                    0.826809351	0.6869122607	0.740506639	0.6420160345
                    0.689613994	0.5584707646	0.6087115511	0.5219694074
                    0.5605052675	0.4410625185	0.4868208674	0.4122349029
                    0.4491261986	0.342235074	0.3831849133	0.3198667685
                    0.3572269169	0.2626191882	0.2988632759	0.2454545354
                    0.2832220522	0.2000824973	0.2319331437	0.1870052099
                    0.2244198366	0.1517068941	0.17956312	0.1417914109
                    0.1780236379	0.1146419819	0.138923405	0.1071490419
                    0.1415292607	0.0864179487	0.1075310147	0.08076971676
                    0.112841149	0.06501475526	0.08333697935	0.06076542485
                    0.09026718756	0.04883143365	0.06470541261	0.04563983668
                    0.07246804105	0.03662210908	0.05035463513	0.03422850718
                    0.058395458	0.02742778848	0.03929145906	0.02563512257
                    0.04723393372	0.02051522135	0.03075112243	0.01917435721
                    0.03835076592	0.01532610804	0.02414682205	0.01432440163
                    0.03125536897	0.01143653285	0.01902910105	0.01068904704
                    0.02556703536	0.008525265222	0.01505394336	0.007968058345
                    0.02098979537	0.006349293846	0.01195804936	0.00593430732
                    0.017292993	0.004725071876	0.009539824757	0.004416243649
                    0.01429635378	0.003514191875	0.007644822913	0.003284506131
                    0.01185853248	0.002612464756	0.006154620279	0.002441715425
                    0.009868334106	0.001941602583	0.004978322265	0.001814700454
                    0.008237978975	0.001442890037	0.004046079039	0.001348583499
                    0.006897927816	0.001072374053	0.003304135494	0.001002284245
                    0.00579289648	0.0007972126095	0.002711052064	0.0007451072101
                    0.004878778883	0.0005929083608	0.002234819322	0.0005541561804
                ]
    ] #end M
    #
    #
    #1 - RT-PCR, 2 - Abbott_PanBio 3 - BTNX_Rapid_Response	4 - Artron
    if x.daysinf+1 > size(M[1],1)
        d = 1
        pp = [0.005 0.015 0.015 0.015]
        prob = pp[1,test]
        
    else
        #Let's create a Tuple with one matrix for each strain
        d = x.daysinf+1 #first row is 0
        prob = M[x.strain][d,test]
    end

    
    return prob
end

