
function days_vac_f(l::Int64)

    v = [i for i in p.day_inital_vac:(p.day_inital_vac+(l-2))]
    
    return v
end

function vaccination_rate_1(sim::Int64)
    
    if p.prov == :canada
        #p.day_inital_vac = 104
        v = [0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 2 5
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 4 10
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 24 68
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 29 75
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 39 79
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 15 27
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 9 22
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 18 44
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 94 283
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 108 211
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 236 419
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 378 548
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 529 760
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 1120 660
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 1569 309
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 1262 168
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 1280 1518 1688 3411 6045 805 88
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 288 372 1047 1341 1554 385 63
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 323 451 1018 1072 1187 199 43
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 694 906 1114 1456 826 135 38
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 1245 1476 1339 1372 488 103 35
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 1400 1382 1245 827 231 66 26
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 1804 1559 962 571 207 62 28
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            17 2440 1492 920 561 340 138 52 34
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            5 911 771 468 328 205 103 47 27
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            2 518 412 266 175 138 71 43 22
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            2 227 309 207 142 117 80 22 -19
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            1 141 252 176 125 98 90 32 15
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            1 101 223 156 114 100 81 27 11
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 122 221 158 112 87 13 26 12
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 105 179 130 98 78 51 24 12
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 108 160 119 89 69 45 22 12
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 81 130 100 73 56 37 21 12
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            -1 78 138 105 74 55 35 17 9
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 82 147 107 75 53 32 16 9
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            2 89 178 125 88 60 36 16 7
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 86 201 130 88 59 34 16 7
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 81 215 144 97 66 37 16 6
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 92 245 184 124 83 49 19 10
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            1 82 225 162 108 72 43 17 4
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            -1 66 170 132 89 61 37 18 8
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            -1 58 155 122 83 58 36 16 8
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            -1 46 117 96 65 48 28 13 8
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            -2 41 110 90 61 44 28 14 8
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            -2 28 84 69 46 32 21 10 3
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            -2 26 70 58 38 26 16 9 4
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            -2 24 64 53 33 22 16 10 7
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            -2 23 68 55 36 24 17 11 7
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            418 22 55 44 29 19 15 9 7
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            1084 -95 -21 44 14 -46 80 84 80
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            857 18 40 33 20 8 10 17 6
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            596 17 38 33 18 12 18 20 10
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            298 6 52 35 23 16 29 22 14
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            162 6 27 21 15 11 16 10 6
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            205 8 46 36 23 12 21 17 10
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            204 12 61 47 32 24 29 17 10        
        ]

    else
        error("no state set")
    end
    rng = MersenneTwister(279*sim)

    if p.scenario == :statuscuo
        v = abs.(v)
    elseif p.scenario == :fast
        v = abs.(v)
        v = Int.(round.(p.α.*v))
    elseif p.scenario == :half
        v = Int.(round.(abs.(v/2)))
    else
        v = [0 0 0 0 0 0 0 0;
        0 0 0 0 0 0 0 0]
    end

    rp = Int.(round.(mean(v[end-30:end,:],dims=1)))
    l2 = p.daysofvac-(size(v,1))
    if l2 > 0
        v2 = repeat(rp,l2)
        v2 = Int.(p.α3.*v2)
    
        for i = 1:l2
            aux = sum(v2[i,:])
            aux = Int(round(p.α2*aux))
            aux_v = sample(rng,1:size(v2,2),aux)
    
            for j in aux_v
                v2[i,j] = v2[i,j] + 1
            end
        end
        v = [v;v2]
    end

    return v
end

function vaccination_rate_2(sim::Int64)
    
    
    if p.prov == :canada
        v = [0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 1 1
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 3 10
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 5 16
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 15 42
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 53 170
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 24 53
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 11 26
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 8 25
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 8 28
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 9 33
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 17 47
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 72 87
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 221 296 311 344 261 96 99
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 15 18 20 25 24 66 65
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 25 30 32 36 32 50 63
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 39 48 50 56 50 41 53
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 78 91 112 130 112 73 95
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 78 86 90 97 76 64 123
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 110 126 130 154 228 163 163
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 31 166 181 195 292 498 519 468
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 39 272 320 361 627 1217 1303 628
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 71 482 554 752 1156 1627 1305 480
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 124 748 858 1108 1470 1808 1256 440
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 344 1204 1264 1368 1679 1719 835 277
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 454 1275 1298 1377 1538 1189 452 191
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            1 627 1311 1225 1139 1083 690 273 116
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            4 693 1151 1046 938 775 477 236 85
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            5 611 896 718 577 470 308 151 47
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            4 395 563 421 336 288 201 86 28
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            3 349 479 358 284 242 165 61 24
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            1 324 396 287 226 187 128 49 20
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            1 221 332 241 191 160 100 43 20
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 142 288 194 144 111 66 29 13
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 112 274 187 135 101 60 26 12
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 108 282 202 143 107 65 27 13
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            1 108 295 197 136 99 58 25 10
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            1 102 269 184 127 90 55 27 13
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 94 246 173 120 87 51 23 12
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 85 222 165 114 78 45 19 11
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 90 231 176 118 82 49 22 13
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            1 67 193 145 98 69 41 18 8
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            1 56 148 117 77 54 33 15 7
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            1 50 129 106 70 49 30 15 9
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            1 44 128 103 69 49 31 16 9
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            85 38 102 82 54 38 26 13 9
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            22 87 16 70 33 31 91 95 101
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            7 23 66 52 30 15 13 18 7
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            12 18 60 47 27 18 19 19 10
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            20 3 64 36 22 10 17 11 9
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            35 5 29 23 16 11 13 9 6
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            88 4 47 38 27 13 19 17 11
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            0 0 0 0 0 0 0 0 0
            140 8 59 46 34 24 27 16 11        
        ]
    else
        error("no state set")
    end

    rng = MersenneTwister(279*sim)
    if p.scenario == :statuscuo
        v = abs.(v)
    elseif p.scenario == :fast
        v = abs.(v)
        v = Int.(round.(p.α.*v))
    elseif p.scenario == :half
        v = Int.(round.(abs.(v/2)))
    else
        v = [0 0 0 0 0 0 0 0;
        0 0 0 0 0 0 0 0]
    end

    
    
    rp = Int.(round.(mean(v[end-30:end,:],dims=1)))
    l2 = p.daysofvac-(size(v,1))
    if l2 > 0
        v2 = repeat(rp,l2)
        v2 = Int.(p.α3.*v2)
    
        for i = 1:l2
            aux = sum(v2[i,:])
            aux = Int(round(p.α2*aux))
            aux_v = sample(rng,1:size(v2,2),aux)
    
            for j in aux_v
                v2[i,j] = v2[i,j] + 1
            end
        end
        v = [v;v2]
    end

    return v
end


function temporal_proportion()
    
    if p.prov == :canada
        v = [1]
        fd = [0.77 0.23 0.0]
        sd = [0.77 0.23 0.0]

    else
       error("no distribution for proportion")
    end

    if !p.using_jj
        sd[:,3] .= 0
        fd[:,3] .= 0
    end

    return v,fd,sd
end


function get_breaks_vac()

    if p.prov == :canada
        brak = @SVector [5:11,12:17, 18:29, 30:39, 40:49, 50:59,60:69, 70:79, 80:100]
    else
        #brak = @SVector [12:15, 16:17, 18:24, 25:39, 40:49, 50:64, 65:74, 75:100]
        error("no age breaks")
    end
    return brak
end


function waning_factor()
    M = [1	1	1	1;
    0.9985	0.9972	1	1;
    0.9951	0.9934	1	1;
    0.9897	0.9885	1	1;
    0.9824	0.9825	1	1;
    0.9733	0.9756	1	1;
    0.9623	0.9676	1	1;
    0.9496	0.9587	1	1;
    0.9352	0.9488	0.9993	1;
    0.9192	0.9381	0.9963	1;
    0.9016	0.9264	0.991	1;
    0.8827	0.9139	0.9835	0.9989;
    0.8625	0.9006	0.9737	0.9961;
    0.8411	0.8866	0.9619	0.9917;
    0.8186	0.8718	0.948	0.9856;
    0.7951	0.8563	0.9321	0.9779;
    0.7708	0.8402	0.9145	0.9686;
    0.7457	0.8235	0.895	0.9578;
    0.7201	0.8063	0.874	0.9454;
    0.6939	0.7886	0.8515	0.9316;
    0.6674	0.7705	0.8277	0.9164;
    0.6406	0.7519	0.8027	0.8999;
    0.6137	0.733	0.7766	0.8822;
    0.5868	0.7138	0.7497	0.8633;
    0.5599	0.6944	0.722	0.8434;
    0.5332	0.6747	0.6938	0.8226;
    0.5068	0.655	0.6651	0.8009;
    0.4808	0.6351	0.6361	0.7785;
    0.4551	0.6151	0.607	0.7555;
    0.43	0.5951	0.5779	0.7319;
    0.4055	0.5752	0.549	0.708;
    0.3816	0.5553	0.5202	0.6837;
    0.3585	0.5356	0.4919	0.6591;
    0.336	0.5159	0.464	0.6345;
    0.3144	0.4965	0.4367	0.6098;
    0.2936	0.4773	0.41	0.5852;
    0.2736	0.4583	0.3841	0.5607;
    0.2544	0.4396	0.359	0.5365;
    0.2362	0.4213	0.3348	0.5125;
    0.2188	0.4032	0.3115	0.4889;
    0.2023	0.3855	0.2891	0.4658;
    0.1867	0.3682	0.2677	0.4431;
    0.1719	0.3513	0.2474	0.4209;
    0.158	0.3348	0.228	0.3993;
    0.1449	0.3187	0.2097	0.3783;
    0.1327	0.3031	0.1924	0.358;
    0.1212	0.2879	0.1762	0.3383;
    0.1105	0.2732	0.1609	0.3193;
    0.1006	0.259	0.1466	0.301;
    0.0914	0.2452	0.1333	0.2835;
    0.0828	0.2319	0.1209	0.2666;
    0.0749	0.2192	0.1094	0.2504;
    0.0677	0.2068	0.0988	0.235;
    0.061	0.195	0.089	0.2203;
    0.0548	0.1837	0.08	0.2062;
    0.0492	0.1728	0.0717	0.1929;
    0.0441	0.1624	0.0642	0.1802;
    0.0394	0.1524	0.0573	0.1682;
    0.0352	0.1429	0.051	0.1569;
    0.0313	0.1339	0.0453	0.1461;
    0.0278	0.1253	0.0402	0.136;
    0.0247	0.1171	0.0355	0.1264;
    0.0219	0.1093	0.0313	0.1174;
    0.0193	0.102	0.0276	0.109;
    0.017	0.095	0.0242	0.101;
    0.015	0.0884	0.0212	0.0936;
    0.0132	0.0822	0.0186	0.0866;
    0.0115	0.0763	0.0162	0.0801;
    0.0101	0.0708	0.0141	0.074;
    0.0088	0.0656	0.0122	0.0683;
    0.0077	0.0607	0.0106	0.063;
    0.0067	0.0562	0.0092	0.058;
    0.0058	0.0519	0.0079	0.0534;
    0.005	0.0479	0.0068	0.0491;
    0.0043	0.0441	0.0058	0.0451;
    0.0037	0.0406	0.005	0.0414;
    0.0032	0.0374	0.0043	0.038;
    0.0028	0.0343	0.0036	0.0348;
    0.0024	0.0315	0.0031	0.0319;
    0.002	0.0289	0.0026	0.0292;
    0.0017	0.0264	0.0022	0.0266;
    0.0015	0.0242	0.0019	0.0243;
    0.0013	0.0221	0.0016	0.0222;
    0.0011	0.0202	0.0013	0.0202;
    0.0009	0.0184	0.0011	0.0184;
    0.0008	0.0168	0.0009	0.0167;
    0.0006	0.0152	0.0008	0.0152;
    0.0005	0.0139	0.0006	0.0138;
    0.0005	0.0126	0.0005	0.0125;
    0.0004	0.0114	0.0004	0.0114;
    0.0003	0.0103	0.0004	0.0103;
    0.0003	0.0093	0.0003	0.0093;
    0.0002	0.0085	0.0003	0.0084;
    0.0002	0.0076	0.0002	0.0076;
    0.0002	0.0069	0.0002	0.0068;
    0.0001	0.0062	0.0001	0.0062;
    0.0001	0.0056	0.0001	0.0055;
    0.0001	0.005	0.0001	0.005;
    0.0001	0.0045	0.0001	0.0045;
    0.0001	0.004	0.0001	0.004]

    return M
end


function booster_doses()

    if p.prov == :canada
        v = [0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            0
            4982
            0
            0
            0
            0
            0
            0
            2919
            0
            0
            0
            0
            0
            0
            5593
            0
            0
            0
            0
            0
            0
            3068
            0
            0
            0
            0
            0
            0
            4185
            0
            0
            0
            0
            0
            0
            3882        
        ]
    end

    
    rp = Int.(round.(mean(v[end-30:end])))
    l2 = p.daysofvac-(length(v))
    if l2 > 0
        v2 = repeat([rp],l2)
        v = [v;v2]
    end
    return v
end

function vector_probs()
    if p.prov == :canada
        v = [
                0.00834791519976576
                0.00777207671339835
                0.00737679775241734
                0.00822835551403693
                0.00994750528084326
                0.010072293524257
                0.0110392281254575
                0.0109301255550985
                0.0113198273878823
                0.0100907677614105
                0.0119120486883292
                0.0134506389297491
                0.0143109109541769
                0.0154524793820542
                0.0150362861903334
                0.0137451810126671
                0.013039325725201
                0.013272519397949
                0.0158003527533585
                0.016075374887586
                0.0159774265736216
                0.0139435176341822
                0.0111960848560055
                0.00942987807003479
                0.0171315435399427
                0.00523692337722998
                0.0060658240555482
                0.00556632251138083
                0.00721296961162274
                0.00522925482595874
                0.00407095501348968
                0.00372029307808677
                0.0036965902832484
                0.00327725995691668
                0.00319743730959336
                0.00248356490034369
                0.00204785175993252
                0.00152952740809938
                0.00144621905565277
                0.00150094462608841
                0.00171810405526934
                0.00165780135663643
                0.00148421324149662
                0.00123045390852115
                0.00103420871007996
                0.00100248879345803
                0.00118548831243072
                0.00125764240848281
                0.0012189510816143
                0.00112309419072384
                0.00109660283178684
                0.000819837844997665
                0.000812866434751086
                0.000912906171789491
                0.0010526829472334
                0.00151872172221719
                0.00100318593448269
                0.000908374755129215
                0.000779055095055179
                0.000803455030918204
                0.000857832030841519
                0.00100911163319228
                0.0010021402229457
                0.000959963190953898
                0.00084423778086069
                0.000667512531109918
                0.000756746582266127
                0.000805197883479849
                0.000919529011523741
                0.000916043306400452
                0.000946717511485398
                0.00090663190256757
                0.000832037812929177
                0.000745243755359272
                0.000851209191107269
                0.000959963190953898
                0.000882929107729203
                0.000898266210271676
                0.00077522081941956
                0.000645901159345524
                0.000675181082381155
                0.000716660973348299
                0.00082785496678123
                0.00090349476795661
                0.000929288985868951
                0.000870031998773032
                0.000618015518359209
                0.000646946870882511
                0.000794740768109981
                0.000889203376951123
                0.00096275175505253
                0.00100876306267995
                0.000920923293573057
                0.000786723646326415
                0.000791952204011349
                0.00100876306267995
                0.00116666550476496
                0.00119838542138689
                0.0011129856458663
                0.000920226152548399
                0.000809729300140125
                0.000926151851257991
                0.00123045390852115
                0.0012900594661294
                0.00143889907489386
                0.00142913910054865
                0.00129528802381434
                0.000980877421693634
                0.00118618545345538
                0.00126670524180336
                0.00154312165808021
                0.00153963595295692
                0.00159924151056517
                0.0014911846517432
                0.00121581394700334
                0.00149153322225553
                0.00151035602992129
                0.00172612117705291
                0.00160516720927476
                0.00160969862593504
                0.00134269361349107
                0.00133084221607189
                0.00134443646605272
                0.00151105317094595
                0.00158111584392407
                0.00177561818980362
                0.0016344471323104
                0.00149292750430485
                0.00140961915185823
                0.00135837928654588
                0.00147271041458977
                0.00169440126043097
                0.00161318433105833
                0.00145632760051031
                0.00126914523538967
                0.00115690553041975
                0.001031071575469
                0.00144099049796783
                0.00140229917109932
                0.00145040190180072
                0.00141101343390755
                0.00133781362631847
                0.00101399162036488
                0.000953340351219648
                0.00110392281254575
                0.00136569926730478
                0.00131341369045544
                0.00117259120347455
                0.00115934552400605
                0.000813215005263415
                0.000717358114372956
                0.000990985966551174
                0.00100318593448269
                0.00103246585751832
                0.000952294639682661
                0.000842843498811375
                0.000620455511945511
                0.00068982104389897
                0.00065705541574005
                0.000787420787351073
                0.000842146357786717
                0.000746289466896258
                0.000648689723444156
                0.000469175909594752
                0.000421421749405687
                0.00063091262731538
                0.00047649589035366
                0.000529827178739987
                0.000504381531339975
                0.000333930550811124
                0.000256896467586428
                0.000244347929142586
                0.000378547576389228
                0.000268050723980954
                0.000316153454682348
                0.000311622038022071
                0.000266656441931638
                0.000201473756126127
                0.000151976743375417
                0.000235285095822034
                0.000180210954874061
                0.000215416576619284
                0.000198685192027495
                0.000139428204931576
                0.00011816540367951
                9.23711857671688e-05
                0.000173588115139812
                0.000132456794684997
                0.000138382493394589
                0.000148142467739799
                0.000132805365197326
                0.000117119692142524
                9.48111793534714e-05
                0.000165570993356246
                0.000136291070320615
                0.000268399294493283
                0.000197639480490508
                0.000193108063830232
                0.000152673884400075
                0.000132108224172668
                0.000182650948460364
                0.000145005333128839
                0.000149188179276786
                0.000210536589446679
                0.000191016640756259
                0.000209839448422021
                0.0002300565381371
                0.000176028108726114
                0.000232845102235731
                0.000232845102235731
                0.000246787922728889
                0.000252713621438481
                0.000216462288156271
                0.000195199486904206
                0.000279553550887809
                0.000334279121323453
                0.000352753358476886
                0.000385867557148135
                0.000365301896920728
                0.000281296403449454
                0.000330793416200163
                0.000429787441701582
                0.000482770159575581
                0.000496712980068738
                0.000515535787734501
                0.000489044428797501
                0.000441987409633095
                0.000429438871189253
                0.000530175749252316
                0.000657752556764708
                0.000718055255397614
                0.000756049441241469
                0.000718752396422272
                0.000570958499194802
                0.000735135210501732
                0.000862014876989466
                0.000947414652510056
                0.00111681992150192
                0.0010335115690553
                0.00090349476795661
                0.000872123421847005
                0.00109834568434849
                0.00130295657508557
                0.00139428204931576
                0.00163200713872409
                0.0017609782282858
                0.001480378965861
                0.00140613344673494
                0.00159924151056517
                0.00188088648452696
                0.00199033762539824
                0.00209142307397363
                0.00230718822110525
                0.00216532002258737
                0.00187600649735435
                0.00220923990714082
                0.00254351902846427
                0.00257872465020949
                0.00272791282948628
                0.00278891266914384
                0.00257593608611086
                0.00233123958645594
                0.00263693592576842
                0.00272860997051093
                0.00294542082917953
                0.00290707807282335
                0.00290812378436034
                0.00270107290003695
                0.00246404495165327
                0.00251075340030535
                0.00272895854102326
                0.00289487810489184
                0.00304580913673027
                0.00292136946382884
                0.00293461514329734
                0.00253585047719303
                0.00289696952796581
                0.00297121504709188
                0.0030907747328207
                0.00325599715566462
                0.00333581980298795
                0.00299700926500422
                0.00262891880398486
                0.00297644360477681
                0.0030172263547193
                0.0029774893163138
                0.00322183724545638
                0.00278682124606987
                0.0024908848811026
                0.00227267974038468
                0.00218449140076546
                0.002247582663497
                0.00237794803510802
                0.00241245651582859
                0.00202345182406949
                0.00192166923446944
                0.00170032695914056
                0.00159436152339257
                0.00178677244619814
                0.00186973222813243
                0.00177596676031594
                0.00181256666411048
                0.00140857344032124
                0.00125694526745815
                0.00131585368404174
                0.00134757360066368
                0.00139776775443905
                0.00146887613895415
                0.00125450527387185
                0.00117956261372113
                0.000982620274255279
                0.00099203167808816
                0.00120082541497319
                0.00123359104313212
                0.0012057054021458
                0.00105338008825805
                0.00112344276123617
                0.000982968844767608
                0.00105860864594299
                0.00105442579979504
                0.00100248879345803
                0.00117224263296222
                0.000987151690915555
                0.000980180280668977
                0.000856437748792203
                0.000904889050005926
                0.000994123101162134
                0.00114853983812385
                0.00112204847918685
                0.00109241998563889
                0.00100946020370461
                0.00097251172939774
                0.00100318593448269
                0.000984711697329253
                0.00112204847918685
                0.00107743145360875
                0.0011551626778581
                0.000908026184616886
                0.000832037812929177
                0.000879094832093584
                0.000997608806285423
                0.00121964822263896
                0.00109555712024986
                0.00110880279971836
                0.00111019708176767
                0.00093312326150457
                0.00103420871007996
                0.00127855663922255
                0.00129981944047461
                0.00140195060058699
                0.00142321340183906
                0.00112727703687179
                0.00098575740886624
                0.00130225943406092
                0.00153266454271034
                0.00162538429898984
                0.00163479570282272
                0.00169997838862824
                0.00146539043383086
                0.00139811632495137
                0.00161388147208299
                0.00185544083712694
                0.00196977196517083
                0.00207643454194349
                0.00207573740091883
                0.00200218902281743
                0.00163096142718711
                0.00182128092691871
                0.00246787922728889
                0.0024619535285793
                0.00237341661844775
                0.00263693592576842
                0.00239119371457652
                0.00219146281101204
                0.0023873594389409
                0.00290010666257677
                0.00302036348933026
                0.00305556911107548
                0.00290707807282335
                0.00291823232921788
                0.00259580460531361
                0.00275754132303424
                0.00248774774649164
                0.00259231890019032
                0.00261846168861499
                0.00294402654713022
                0.00260626172068348
                0.0022451426699107
                0.00201822326638456
                0.00205761173427773
                0.00283352969472195
                0.00142635053645002
                0.00236888520178747
                0.00238596515689159
                0.00215974289439011
                0.00222422843917096
                0.00233298243901759
                0.00240339368250803
                0.00233786242619019
                0.0024427821504012
                0.00223642840710247
                0.00221411989431342
                0.00234622811848609
                0.00229359397112442
                0.00233890813772718
                0.00236017093897925
                0.00234901668258472
                0.00219425137511067
                0.00208480023423938
                0.00226535975962577
                0.0024354621696423
                0.00243964501579024
                0.00219599422767232
                0.0022632683365518
                0.00219843422125862
                0.00185753226020092
                0.00212732583674351
                0.00225734263784221
                0.00226431404808879
                0.00207992024706678
                0.00196280055492426
                0.00175052111291593
                0.00170416123477618
                0.00199138333693523
                0.00188855503579819
                0.0019885947728366
                0.00173169830525017
                0.00161806431823093
                0.00161771574771861
                0.00149048751071854
                0.00167383560020357
                0.00167488131174055
                0.00183592088843652
                0.0016525727989515
                0.00173622972191045
                0.00158913296570763
                0.0014995503440391
                0.00142425911337604
                0.00160133293363915
                0.00148003039534868
                0.00127890520973488
                0.0013670935493541
                0.00114435699197591
                0.00103664870366626
                0.00114087128685262
                0.00113076274199508
                0.00120082541497319
                0.00120500826112114
                0.00103037443444434
                0.000940791812775806
                0.000932077549967583
                0.00143227623515961
                0.000747683748945574
                0.000776266530956547
                0.000900706203857978
                0.000971814588373082
                0.000931380408942925
                0.000784632223252442
                0.00114644841504988
                0.000636838326024972
                0.0007720836848086
                0.000828203537293559
                0.000817397851411362
                0.000872820562871663
                0.00140892201083357
                0.000339856249520716
                0.000587341313274262
                0.000718752396422272
                0.000891643370537426
                0.000849117768033295
                0.00062742692219209
                0.000823672120633283
                0.000977391716570345
                0.000587341313274262
                0.000631609768340038
                0.000740363768186666
                0.000619409800408525
                0.000626381210655103
                0.000578627050466039
                0.000758489434827771
                0.000506821524926277
                0.000423513172479661
                0.000474753037792015
                0.000467433057033107
                0.000379941858438544
                0.000435015999386516
                0.000615575524772906
                0.000304999198287822
                0.000300816352139874
                0.000363907614871412
                0.000390398973808412
                0.000329050563638518
                0.000276416416276849
                0.000470918762156397
                0.00018055952538639
                0.000179513813849404
                0.000244696499654915
                0.000219599422767232
                0.000190319499731601
                0.000559804242800276
                8.60969165452479e-05
                0.000139428204931576
                0.000129319660074036
                0.000219947993279561
                0.000198685192027495
                0.000173588115139812
                0.000166268134380904
                0.000351359076427571
                9.30683267918267e-05
                0.000126531095975405
                0.00016103957669597
                0.000150233890813773
                0.000156159589523365
                0.000112588275482247
                0.000261427884246704
                9.30683267918267e-05
                8.95826216685373e-05
                0.000173936685652141
                0.000133502506221984
                0.000117119692142524
                9.82968844767608e-05
                0.000273627852178217
                6.90169614411299e-05
                8.26112114219586e-05
                0.000145702474153497
                0.00014117105749322
                0.000147445326715141
                0.000100736878063063
                0.000237376518896007
                8.0171217835656e-05
                8.22626409096296e-05
                0.00014779389722747
                0.000130365371611023
                0.000137685352369931
                0.000264913589369994
                5.1239865312354e-05
                9.93425960137476e-05
                0.000100039737038405
                0.000178816672824746
                0.000136988211345273
                0.000143611051079523
                0.00013803392288226
                0.000239119371457652
                0.000123742531876773
                0.000121999679315129
                0.000186136653583653
                0.000150582461326102
                0.000189273788194614
                0.000199033762539824
                0.000273976422690546
                0.00011816540367951
                0.00011502826906855
                0.00014117105749322
                0.000152325313887746
                0.000118862544704168
                0.000115376839580879
                0.000196942339465851
                8.50512050082611e-05
                7.70340832246955e-05
                0.000111891134457589
                0.000129319660074036
                9.30683267918267e-05
                8.08683588603139e-05
                0.000139079634419247
                7.63369422000376e-05
                7.87769357863402e-05
                0.000111193993432932
                0.000197639480490508
                0
                9.96911665260766e-05
                0.000232845102235731
                7.59883716877087e-05
                8.29597819342875e-05
                5.99541281205775e-05
                0.000132456794684997
                9.7251172939774e-05
                0.000113633987019234
                0.000104571153698682
                0.000110845422920603
                0.000135942499808286
                0.000142565339542536
                0.000127925378024721
                0.00013454821775897
                0.00011154256394526
                0.000125485384438418
                0.00013141108314801
                0.000162782429257615
                0.000143959621591852
                0.00014117105749322
                0.000164525281819259
                0.000142565339542536
                0.000189970929219272
                0.000223782268915179
                0.000251667909901494
                0.000212279442008324
                0.00022343369840285
                0.000235285095822034
                0.000245742211191902
                0.000264216448345336
                0.000263867877833007
                0.000269096435517941
                0.000315804884170019
                0.000346130518742636
                0.000303953486750835
                0.000326261999539887
                0.000352753358476886
                0.000375759012290596
                0.000397718954567319
                0.000402947512252253
                0.000418633185307056
                0.000352404787964557
                0.000362513332822097
                0.000372970448191965
                0.000396673243030333
                0.000436061710923503
                0.000392490396882385
                0.000422118890430345
                0.000390747544320741
                0.000409570351986503
                0.000394930390468688
                0.000399461807128964
                0.000441987409633095
                0.000527038614641356
                0.000497061550581067
                0.000505078672364633
                0.000444078832707068
                0.000452444525002963
                0.000962054614027872
                0.000576187056879736
                0.000636141185000314
                0.000570958499194802
                0.000547952845381092
                0.000531918601813961
                0.000559455672287947
                0.000537844300523553
                0.000510307230049567
                0.000619758370920854
                0.000669255383671563
                0.000615924095285235
                0.000554227114603013
                0.000713175268225009
                0.000500547255704356
                0.000511701512098882
                0.00062428978758113
                0.000598495569668788
                0.000459415935249542
                0.000482073018550923
                0.000452444525002963
                0.000370879025117991
                0.000407130358400201
                0.000482770159575581
                0.000513792935172856
                0.000484861582649554
                0.000428741730164595
                0.000403296082764582
                0.000562592806898908
                0.000475101608304344
                0.000436061710923503
                0.000583158467126315
                0.000369136172556346
                0.00038761040970978
                0.00040747892891253
                0.000302907775213848
                0.000247833634265876
                0.000229010826600113
                0.000220645134304218
                0.000497061550581067
                0.000109102570358958
                7.52912306630508e-05
                4.46170255781042e-05
                0.000115376839580879
                4.35713140411174e-05
                9.65540319151161e-05
                5.05427242876962e-05
                3.48570512328939e-05
                2.61427884246704e-05
                1.95199486904206e-05
                5.92569870959196e-06
                1.32456794684997e-05
                1.21999679315129e-05
                9.06283332055242e-06
                0
                5.22855768493409e-06
                1.7428525616447e-06
                2.09142307397363e-06
                2.09142307397363e-06
                4.18284614794727e-06
                0
                3.13713461096045e-06
                0
                3.13713461096045e-06
                6.97141024657878e-07
                0
                3.48570512328939e-07
                3.48570512328939e-07
                3.48570512328939e-07
                3.48570512328939e-07
                0
                0
                3.48570512328939e-07
                0
                0
                0
                0
                3.48570512328939e-07
                0
                0
                0
                0
                0
                0
                0
                1.04571153698682e-06
                0
                0
                0
                0
                0
                0
                0
                1.39428204931576e-06
        ]
    end

    return v
end

function distribute_vaccine(M1,M2,B)
    braks = get_breaks_vac()
    v,fd,sd = temporal_proportion()

    p2 = Distributions.Categorical(sd[1,:]/sum(sd[1,:]))
    p1 = Distributions.Categorical(fd[1,:]/sum(fd[1,:]))
    ##firstly, let's distribute age-based second doses.
    
    for i in 1:length(braks)
        #println(i)
        pos = findall(y-> y.age in braks[i],humans)

        N = sum(M2[:,i]) ##number of vaccinated
        Vaux = reverse(M2[:,i])
       
        p_day = Distributions.Categorical(Vaux/sum(Vaux))


        n1 = min(N,length(pos))
        pos_vac = sample(pos,n1,replace = false)
        
        ### distributed second dose
        for j in pos_vac
            x = humans[j]
            x.vac_status = 2
            x.vaccine_n = x.age >= 18 ? rand(p2) : 1#rand the vaccine
            x.vaccine = [:pfizer,:moderna,:jensen][x.vaccine_n]
            x.days_vac = rand(p_day) ##rand the day
            x.protected = x.days_vac > p.days_to_protection[x.vaccine_n][x.vac_status][1] ? findfirst(y-> y < x.days_vac,p.days_to_protection[x.vaccine_n][x.vac_status]) : 0
            x.index_day = min(length(p.days_to_protection[x.vaccine_n][x.vac_status]),x.protected+1)

            x.vac_eff_inf = deepcopy(p.vac_efficacy_inf[x.vaccine_n])
            x.vac_eff_symp = deepcopy(p.vac_efficacy_symp[x.vaccine_n])
            x.vac_eff_sev = deepcopy(p.vac_efficacy_sev[x.vaccine_n])

            waning_immunity(x) ##get the immunity
            
            if x.recovered
                index = Int(floor(x.days_recovered/7))

                if index > 0
                    if index <= size(waning_factors_rec,1)
                        aux = waning_factors_rec[index,1]
                    else
                        aux = waning_factors_rec[end,1]
                    end
                else
                    aux = 1.0
                end

                if aux > x.vac_eff_inf[1][x.vac_status][end]
                    x.recvac = 1
                else
                    x.recvac = 2
                end
            end
        end

        N_aux = n1

        pos = findall(y-> y.age in braks[i] && y.vac_status <= 0,humans)
        
        N = sum(M1[:,i]) ##number of vaccinated first dose
        n1 = min(N-N_aux,length(pos)) #number of first dose that didn't take second dose yet
        Vaux = reverse(M1[:,i])
        aux = findfirst(y-> y >= n1, cumsum(Vaux))

        p_day = Distributions.Categorical(Vaux[1:aux]/sum(Vaux[1:aux]))

        pos_vac = sample(pos,n1,replace = false)
        
        for j in pos_vac
            #println(j)
            x = humans[j]
            x.vac_status = 1
            
            x.vaccine_n = x.age >= 18 ? rand(p1) : 1#rand the vaccine
                
            x.vaccine = [:pfizer,:moderna,:jensen][x.vaccine_n]
            x.days_vac = rand(p_day) ##rand the day
            x.protected = x.days_vac > p.days_to_protection[x.vaccine_n][x.vac_status][1] ? findfirst(y-> y < x.days_vac,p.days_to_protection[x.vaccine_n][x.vac_status]) : 0
            x.index_day = min(length(p.days_to_protection[x.vaccine_n][x.vac_status]),x.protected+1)

            x.vac_eff_inf = deepcopy(p.vac_efficacy_inf[x.vaccine_n])
            x.vac_eff_symp = deepcopy(p.vac_efficacy_symp[x.vaccine_n])
            x.vac_eff_sev = deepcopy(p.vac_efficacy_sev[x.vaccine_n])

            if x.recovered
                index = Int(floor(x.days_recovered/7))

                if index > 0
                    if index <= size(waning_factors_rec,1)
                        aux = waning_factors_rec[index,1]
                    else
                        aux = waning_factors_rec[end,1]
                    end
                else
                    aux = 1.0
                end

                if aux > x.vac_eff_inf[1][x.vac_status][end]
                    x.recvac = 1
                else
                    x.recvac = 2
                end
            end
        end
        

    end #end for age breaks
    

    ### know I want to distribute booster
    Baux = reverse(B)
    for i = 1:length(Baux)
        pos = findall(y-> y.vac_status == 2 && y.boosted == 0 && y.days_vac >= p.booster_after[y.vaccine_n]+(i-1) && y.age >= p.min_age_booster,humans)

        n1 = min(Baux[i],length(pos))
        pos_vac = sample(pos,n1,replace = false)
        for j in pos_vac
            x = humans[j]
            x.days_vac = (i-1) ##rand the day
            x.protected = length(p.days_to_protection[x.vaccine_n][x.vac_status])
            x.index_day = min(length(p.days_to_protection[x.vaccine_n][x.vac_status]),x.protected+1)

            x.vac_eff_inf = deepcopy(p.vac_efficacy_inf[x.vaccine_n])
            x.vac_eff_symp = deepcopy(p.vac_efficacy_symp[x.vaccine_n])
            x.vac_eff_sev = deepcopy(p.vac_efficacy_sev[x.vaccine_n])

            if x.recovered
                index = Int(floor(x.days_recovered/7))

                if index > 0
                    if index <= size(waning_factors_rec,1)
                        aux = waning_factors_rec[index,1]
                    else
                        aux = waning_factors_rec[end,1]
                    end
                else
                    aux = 1.0
                end

                if aux > x.vac_eff_inf[1][x.vac_status][end]
                    x.recvac = 1
                else
                    x.recvac = 2
                end
            end
        end

    end


end

function _get_prob_test(x::Human)

    if x.daysinf > 0 
        prob = 1.0
    else
        prob = 0.0
    end

    return prob
end


function _get_prob_test_pcr(x::Human)

    if x.daysinf > 0 
        prob = 1.0
    else
        prob = 0.0
    end

    return prob
end