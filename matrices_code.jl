


function vaccination_rate_1(sim::Int64)
    #must be written as the temporal series of vaccines per age group
    if p.prov == :ontario
        v = [0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 162 543
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 37 72
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 63 320
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 107 679
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 221 879
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 1273 741
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 1948 302
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 1302 127
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 1311 1477 1686 3614 5786 775 78
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 286 382 1077 1511 1577 329 53
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 392 517 1154 1175 1099 212 44
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 1070 1059 1143 1236 670 150 40
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 1665 1409 1100 1115 450 118 35
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 1730 1432 1104 947 272 81 27
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 1457 1134 775 606 190 61 23
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 2402 1325 974 661 396 149 43 43
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 772 796 591 429 244 107 58 40
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 515 462 322 195 138 75 51 30
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 306 364 243 158 160 70 9 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 176 272 189 125 105 59 25 10
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 123 261 179 127 110 65 27 10
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 171 239 163 113 98 60 25 9
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 145 199 139 104 91 57 26 9
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 149 168 121 91 78 49 23 9
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 99 115 85 61 51 32 14 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 89 124 90 65 55 33 15 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 91 145 101 72 59 33 14 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 89 149 103 74 56 30 12 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 93 182 118 79 58 31 12 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 98 249 154 102 72 38 15 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 73 190 135 87 64 34 13 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 75 229 150 98 71 38 16 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 64 174 119 79 59 33 14 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 52 148 110 74 56 32 13 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 42 109 82 55 44 23 9 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 41 101 80 54 41 25 10 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 32 83 64 43 34 20 9 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 27 67 52 34 27 16 7 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 26 64 51 32 25 15 9 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 25 66 49 30 25 15 8 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                571 21 54 41 26 21 14 8 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                877 0 0 59 0 0 170 187 136
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                755 14 40 37 21 13 17 10 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                473 13 40 34 19 17 23 13 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                291 3 54 44 26 17 37 26 17
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                194 11 38 25 15 13 11 5 2
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                201 10 71 48 26 20 22 11 1
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                234 15 84 57 30 25 28 14 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                167 12 82 51 25 18 21 12 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                97 8 73 43 22 13 18 11 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                56 9 68 40 19 10 14 8 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                40 8 60 31 16 8 13 10 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                20 4 47 23 10 3 12 9 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                13 1 28 16 7 2 9 7 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                8 0 20 13 7 0 8 5 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                7 0 12 12 5 0 9 6 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                7 0 6 9 5 0 8 8 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 4 11 3 0 8 7 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0        
        ]

    else
        error("no state set")
    end
    
    return v
end

function vaccination_rate_2(sim::Int64)
    #must be written as the temporal series of vaccines per age group
    
    
    if p.prov == :ontario
        v = [0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 109 363
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 14 39
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 9 35
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 13 58
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 11 53
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 9 38
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 13 38
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 12 16
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 231 275 299 364 283 14 23
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 7 8 10 14 20 21 19
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 9 9 10 15 21 21 16
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 10 11 14 20 26 23 15
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 33 35 38 47 46 30 16
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 117 129 132 143 99 44 21
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 142 161 165 192 299 61 36
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 23 174 188 199 261 369 354 768
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 24 341 375 405 668 1207 1439 707
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 91 737 758 817 1257 1637 1451 520
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 188 1073 1112 1379 1831 1666 1122 335
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 379 1580 1486 1470 1775 1566 820 280
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 693 1738 1514 1485 1539 1156 445 199
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 841 1415 1141 1050 1058 721 313 150
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 678 1029 824 748 752 498 268 86
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 507 676 514 458 453 319 163 48
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 307 439 330 275 265 184 83 25
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 268 390 294 236 226 155 60 20
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 227 318 230 180 168 112 42 16
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 195 268 189 150 131 80 32 13
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 153 218 144 109 92 55 23 9
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 122 292 183 130 104 58 23 9
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 95 259 172 119 99 55 22 9
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 119 366 220 149 111 57 23 10
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 113 315 186 127 94 51 21 8
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 102 270 173 117 89 48 19 8
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 85 221 147 99 72 37 14 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 80 206 145 98 74 41 17 7
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 64 177 129 86 67 37 15 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 53 132 100 63 52 29 12 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 50 120 94 63 48 27 12 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 45 114 85 55 44 25 11 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                209 35 90 70 45 36 21 10 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 77 0 0 186 212 189
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 20 65 53 31 23 22 12 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 16 57 45 25 22 23 12 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                11 0 56 42 27 17 34 24 17
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                54 12 32 22 14 12 7 3 1
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                144 3 63 45 26 20 20 10 1
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                243 7 70 51 31 24 26 13 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                294 7 73 48 26 20 19 12 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                514 13 78 48 26 16 20 12 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                414 16 90 53 27 16 17 9 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                315 14 85 45 24 15 17 11 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                227 10 68 36 18 9 16 10 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                137 6 43 25 12 7 11 8 3
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                106 4 33 21 11 2 10 6 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                98 2 22 17 8 3 11 7 6
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                106 2 12 12 7 1 10 8 5
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                62 0 9 14 5 1 9 7 4
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0        
        ]
    else
        error("no state set")
    end


    return v
end


function temporal_proportion()
    
    if p.prov == :ontario
        v = [1]
        fd = [0.78 0.22 0.0]
        sd = [0.78 0.22 0.0]

    else
       error("no distribution for proportion")
    end

    if !p.using_jj
        sd[:,3] .= 0
        fd[:,3] .= 0
    end

    return v,fd,sd
end


function get_breaks_vac()

    if p.prov == :ontario
        brak = @SVector [5:11,12:17, 18:29, 30:39, 40:49, 50:59,60:69, 70:79, 80:100]
    else
        #brak = @SVector [12:15, 16:17, 18:24, 25:39, 40:49, 50:64, 65:74, 75:100]
        error("no age breaks")
    end
    return brak
end


function waning_factor()
    M = [1	1	1	1
        0.9985	0.9972	1	1
        0.9951	0.9934	1	1
        0.9897	0.9885	0.9999	1
        0.9824	0.9825	0.9991	0.9999
        0.9733	0.9756	0.9977	0.9995
        0.9623	0.9676	0.9955	0.9989
        0.9496	0.9587	0.9927	0.998
        0.9352	0.9488	0.9891	0.9968
        0.9192	0.9381	0.9849	0.9954
        0.9016	0.9264	0.98	0.9938
        0.8827	0.9139	0.9745	0.9918
        0.8625	0.9006	0.9684	0.9897
        0.8411	0.8866	0.9616	0.9873
        0.8186	0.8718	0.9541	0.9846
        0.7951	0.8563	0.9461	0.9817
        0.7708	0.8402	0.9375	0.9785
        0.7457	0.8235	0.9284	0.9751
        0.7201	0.8063	0.9186	0.9714
        0.6939	0.7886	0.9084	0.9676
        0.6674	0.7705	0.8976	0.9634
        0.6406	0.7519	0.8864	0.9591
        0.6137	0.733	0.8747	0.9545
        0.5868	0.7138	0.8625	0.9497
        0.5599	0.6944	0.8499	0.9447
        0.5332	0.6747	0.8369	0.9394
        0.5068	0.655	0.8236	0.934
        0.4808	0.6351	0.8098	0.9283
        0.4551	0.6151	0.7958	0.9224
        0.43	0.5951	0.7815	0.9164
        0.4055	0.5752	0.7669	0.9101
        0.3816	0.5553	0.752	0.9036
        0.3585	0.5356	0.7369	0.897
        0.336	0.5159	0.7216	0.8902
        0.3144	0.4965	0.7061	0.8832
        0.2936	0.4773	0.6905	0.876
        0.2736	0.4583	0.6748	0.8686
        0.2544	0.4396	0.659	0.8611
        0.2362	0.4213	0.643	0.8535
        0.2188	0.4032	0.6271	0.8456
        0.2023	0.3855	0.6111	0.8377
        0.1867	0.3682	0.5951	0.8296
        0.1719	0.3513	0.5791	0.8213
        0.158	0.3348	0.5631	0.813
        0.1449	0.3187	0.5473	0.8045
        0.1327	0.3031	0.5314	0.7959
        0.1212	0.2879	0.5157	0.7872
        0.1105	0.2732	0.5001	0.7783
        0.1006	0.259	0.4847	0.7694
        0.0914	0.2452	0.4693	0.7604
        0.0828	0.2319	0.4542	0.7513
        0.0749	0.2192	0.4392	0.7421
        0.0677	0.2068	0.4245	0.7328
        0.061	0.195	0.4099	0.7235
        0.0548	0.1837	0.3956	0.7141
        0.0492	0.1728	0.3815	0.7046
        0.0441	0.1624	0.3676	0.6951
        0.0394	0.1524	0.3541	0.6855
        0.0352	0.1429	0.3407	0.6759
        0.0313	0.1339	0.3277	0.6662
        0.0278	0.1253	0.3149	0.6565
        0.0247	0.1171	0.3024	0.6468
        0.0219	0.1093	0.2902	0.6371
        0.0193	0.102	0.2783	0.6273
        0.017	0.095	0.2667	0.6176
        0.015	0.0884	0.2554	0.6078
        0.0132	0.0822	0.2445	0.598
        0.0115	0.0763	0.2338	0.5883
        0.0101	0.0708	0.2234	0.5785
        0.0088	0.0656	0.2134	0.5688
        0.0077	0.0607	0.2036	0.559
        0.0067	0.0562	0.1942	0.5493
        0.0058	0.0519	0.1851	0.5397
        0.005	0.0479	0.1763	0.53
        0.0043	0.0441	0.1677	0.5204
        0.0037	0.0406	0.1595	0.5109
        0.0032	0.0374	0.1516	0.5013
        0.0028	0.0343	0.144	0.4919
        0.0024	0.0315	0.1367	0.4825
        0.002	0.0289	0.1296	0.4731
        0.0017	0.0264	0.1228	0.4638
        0.0015	0.0242	0.1163	0.4546
        0.0013	0.0221	0.1101	0.4454
        0.0011	0.0202	0.1041	0.4363
        0.0009	0.0184	0.0984	0.4273
        0.0008	0.0168	0.0929	0.4184
        0.0006	0.0152	0.0877	0.4095
        0.0005	0.0139	0.0827	0.4008
        0.0005	0.0126	0.078	0.3921
        0.0004	0.0114	0.0734	0.3835
        0.0003	0.0103	0.0691	0.375
        0.0003	0.0093	0.065	0.3666
        0.0002	0.0085	0.0611	0.3582
        0.0002	0.0076	0.0574	0.35
        0.0002	0.0069	0.0538	0.3419
        0.0001	0.0062	0.0505	0.3339
        0.0001	0.0056	0.0473	0.326
        0.0001	0.005	0.0443	0.3182
        0.0001	0.0045	0.0415	0.3104
        0.0001	0.004	0.0388	0.3029
    ]

    return M
end


function booster_doses()

    if p.prov == :ontario
        v = [0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                7457
                0
                0
                0
                0
                0
                0
                5007
                0
                0
                0
                0
                0
                0
                7052
                0
                0
                0
                0
                0
                0
                5329
                0
                0
                0
                0
                0
                0
                6756
                0
                0
                0
                0
                0
                0
                5729
                0
                0
                0
                0
                0
                0
                3391
                0
                0
                0
                0
                0
                0
                0
                2279
                0
                0
                0
                0
                0
                0
                1504
                0
                0
                0
                0
                0
                0
                1022
                0
                0
                0
                0
                0
                0
                863
                0
                0
                0
                0
                0
                0
                615
                0
                0
                0
                0
                0
                0
                406
                0
                0
                0
                0
                0
                0
                325
                0
                0
                0
                0
                0
                0
                292
                0
                0
                0
                0
                0
                0
                208
                0
                0
                0
                0
        ]
    end

    
    return v
end

function vector_probs()
    #this must be written as the reverse vector of incidence
    if p.prov == :ontario
        v = [0.00242697094362079
                0.00138856546525568
                0.00150154812112431
                0.00191035559350393
                0.00237522316230692
                0.0023812604034602
                0.00220876779908061
                0.00185343303405866
                0.00124798399268631
                0.00104961749764979
                0.00144893787678853
                0.00179219815950391
                0.00215788248078864
                0.00206818632651125
                0.00173441313703675
                0.000928010211562179
                0.000962508732438097
                0.00140667718871553
                0.00173786298912434
                0.0018370462366426
                0.00183273392153311
                0.00167921550363528
                0.00104185533045271
                0.000926285285518383
                0.00154122142013161
                0.00166455363226302
                0.0017982354006572
                0.00195089135553313
                0.00168956505989806
                0.00101425651375197
                0.00113413887379579
                0.00172578850681777
                0.00201643854519737
                0.00209319775414629
                0.00207336110464264
                0.00122900980620456
                0.00110567759407315
                0.00115138813423374
                0.00169560230105134
                0.00193536702113897
                0.00201557608217548
                0.0020069514519565
                0.00218375637144557
                0.00137390359388341
                0.00152224723364986
                0.00195347874459883
                0.00253909113646752
                0.0025071800046573
                0.00276074413309529
                0.00272710807524127
                0.00180427264181048
                0.00180082278972289
                0.00248993074421934
                0.00276333152216099
                0.00349038784962095
                0.00353437346373774
                0.00337136795259903
                0.00226137804341639
                0.00262447497563542
                0.00341535356671583
                0.00418725797131448
                0.00460296514786929
                0.00504713360414672
                0.00462970150154812
                0.00295307338697853
                0.00413119787489111
                0.00503074680673066
                0.00558272314074534
                0.00617954755189871
                0.00669012566086229
                0.00495398759778175
                0.00611141297316878
                0.00734904740959231
                0.00901273857883343
                0.00925595315100865
                0.00945604457208897
                0.00854614608398665
                0.00843747574322751
                0.00685744348711049
                0.00837106609054137
                0.0103141952788774
                0.0115242308986002
                0.0102624474975635
                0.0115043942490966
                0.0099890467196219
                0.00979068022458537
                0.0117105229113302
                0.0144152069480021
                0.0159081304389074
                0.0144143444849802
                0.0119080269433448
                0.00900066409652686
                0.00761123616824929
                0.00812267674023476
                0.00847456165316912
                0.00897996498400131
                0.00825463358258515
                0.00499366089678905
                0.00378017542497865
                0.00297808481461357
                0.00326356007486179
                0.00360250804246768
                0.00284699043528509
                0.00269433448040915
                0.0020880229760149
                0.00155933314359147
                0.00123245965829215
                0.00132474320163523
                0.00127299542032135
                0.00138597807618998
                0.0012531587708177
                0.00111257729824834
                0.000870225189095018
                0.000800365684321285
                0.000765004700423469
                0.00102115621792716
                0.000908173562058527
                0.000889199375576772
                0.000827102038000121
                0.00067272115708039
                0.000592512096043882
                0.000679620861255574
                0.00083141435310961
                0.000736543420700837
                0.000799503221299387
                0.000645122340379656
                0.00050971564594168
                0.000528689832423435
                0.000540764314730006
                0.000639085099226371
                0.000627873079941698
                0.000683933176365063
                0.000613211208569433
                0.000441581067211743
                0.000414844713532907
                0.000476079588087661
                0.000574400372584025
                0.000570088057474536
                0.000515752887094966
                0.000553701260058475
                0.000391558211941663
                0.00038034619265699
                0.000413982250511009
                0.000548526481927087
                0.000438131215124152
                0.000485566681328538
                0.000377758803591296
                0.00032601102227742
                0.000285475260248217
                0.000363959395240929
                0.000293237427445298
                0.000307036835795665
                0.000361372006175235
                0.000352747375956256
                0.000276850630029237
                0.000232002552890545
                0.000281162945138727
                0.000319111318102236
                0.00032169870716793
                0.000424331806773785
                0.000356197228043848
                0.000262188758656973
                0.000282887871182523
                0.00032169870716793
                0.000382071118700786
                0.000419157028642397
                0.000427781658861376
                0.000359647080131439
                0.000263913684700768
                0.000336360578540195
                0.000395008064029255
                0.000461417716715396
                0.00056405081632125
                0.000494191311547517
                0.000506265793854088
                0.000410532398423418
                0.000369996636394215
                0.000440718604189845
                0.000500228552700803
                0.000607173967416147
                0.000576125298627821
                0.000558013575167965
                0.000426919195839478
                0.000401907768204438
                0.000528689832423435
                0.000563188353299352
                0.000551976334014679
                0.0006270106169198
                0.000583887465824903
                0.000399320379138744
                0.000495053774569415
                0.000526102443357741
                0.000616661060657024
                0.000708082140978206
                0.000685658102408859
                0.000745168050919817
                0.000511440571985476
                0.000497641163635109
                0.000517477813138762
                0.000676171009167982
                0.000739130809766531
                0.00073136864256945
                0.000688245491474553
                0.000477804514131457
                0.000486429144350436
                0.000501091015722701
                0.000699457510759226
                0.000814165092671652
                0.000696007658671634
                0.000746030513941715
                0.000565775742365046
                0.000452793086496416
                0.000598549337197168
                0.000638222636204473
                0.000720156623284777
                0.000673583620102288
                0.000584749928846801
                0.000569225594452638
                0.000419157028642397
                0.000551113870992781
                0.00062269830181031
                0.000594237022087678
                0.000560600964233658
                0.000457967864627804
                0.000418294565620499
                0.000300137131620482
                0.000453655549518314
                0.000440718604189845
                0.000498503626657007
                0.000439856141167947
                0.000442443530233641
                0.000279438019094931
                0.000276850630029237
                0.000280300482116829
                0.000364821858262827
                0.00032601102227742
                0.000293237427445298
                0.00018370462366426
                0.000119882360043813
                0.000141443935591262
                0.000144893787678853
                0.00018801693877375
                0.000222515459649668
                0.000194916642948934
                0.00018801693877375
                0.000136269157459874
                0.000111257729824834
                0.000102633099605854
                0.000148343639766445
                0.000146618713722649
                0.000165592900204404
                0.000159555659051118
                0.000116432507956221
                0.000109532803781038
                0.000112120192846732
                0.000152655954875935
                0.000151793491854037
                0.000137131620481772
                0.000123332212131405
                0.000131956842350384
                0.000125919601197099
                9.83207844963647e-05
                0.000143168861635057
                0.000154380880919731
                0.000157830733007322
                0.000181117234598567
                0.0001673178262482
                0.000210440977343096
                0.000146618713722649
                0.00018370462366426
                0.000180254771576669
                0.000172492604379587
                0.000244939498219014
                0.00015869319602922
                0.000257876443547483
                0.000181117234598567
                0.000247526887284708
                0.000298412205576686
                0.000220790533605872
                0.000255289054481789
                0.000219928070583974
                0.000255289054481789
                0.000232865015912443
                0.000274263240963544
                0.000306174372773767
                0.000297549742554788
                0.000319111318102236
                0.000331185800408807
                0.000255289054481789
                0.000385520970788377
                0.000457105401605906
                0.000432956436992764
                0.000495053774569415
                0.000508853182919782
                0.000354472302000052
                0.000404495157270132
                0.000452793086496416
                0.000571812983518332
                0.000641672488292064
                0.000788291202014714
                0.000750342829051204
                0.000632185395051187
                0.000602861652306657
                0.000790016128058509
                0.000890924301620568
                0.000911623414146119
                0.00109791542687607
                0.000978895529854158
                0.00094439700897824
                0.000896099079751956
                0.00124712152966442
                0.00145842497002941
                0.0015472586612849
                0.0016300551113871
                0.00206991125255505
                0.00136959127877392
                0.00139374024338706
                0.00187154475751852
                0.00189655618515356
                0.00222860444858427
                0.00203713765772293
                0.00237953547741641
                0.00200091421080321
                0.00178788584439442
                0.00234244956747479
                0.00277368107842376
                0.00247009409471569
                0.00273055792732887
                0.00295307338697853
                0.00253650374740183
                0.00240713429411714
                0.00296342294324131
                0.0032187119977231
                0.00290563792077415
                0.00335239376611728
                0.00333859435776691
                0.00300137131620482
                0.00281594176649676
                0.00302724520686176
                0.00340414154743115
                0.00353092361165015
                0.0038853959136502
                0.0031755888466282
                0.00363269424823411
                0.00299188422296394
                0.00383537305838012
                0.00366546784306623
                0.0037620637015188
                0.00415017206137287
                0.00408462487170863
                0.00358439631900782
                0.00316523929036543
                0.00379569975937282
                0.0038431352255772
                0.00328857150249683
                0.00364563119356258
                0.0028418156571537
                0.00277281861540186
                0.00264344916211717
                0.00253391635833614
                0.00262275004959162
                0.00259515123289089
                0.00266414827464272
                0.00220531794699302
                0.00201212623008788
                0.00201471361915358
                0.00180599756785428
                0.00211130947760615
                0.00211562179271564
                0.00187068229449662
                0.00205266199211709
                0.00135492940740166
                0.00133336783185421
                0.00146532467420459
                0.0015446712722192
                0.00157744486705133
                0.0015049979732119
                0.00133940507300749
                0.00130059423702209
                0.000926285285518383
                0.00109360311176658
                0.00150672289925569
                0.00126609571614617
                0.00118243680302207
                0.000941809619912546
                0.00113500133681768
                0.00102201868094905
                0.00140667718871553
                0.00112033946544542
                0.000853838391678957
                0.00107807877737242
                0.000857288243766549
                0.000826239574978223
                0.000833139279153406
                0.000882299671401589
                0.000915935729255608
                0.00102201868094905
                0.0010849784815476
                0.000981482918919851
                0.000909036025080425
                0.000840901446350488
                0.000912485877168016
                0.000937497304803057
                0.00105910459089067
                0.000991832475182627
                0.000895236616730058
                0.000730506179547552
                0.000779666571795734
                0.00083141435310961
                0.000846076224481875
                0.00112120192846732
                0.000928010211562179
                0.00081502755569355
                0.000924560359474588
                0.000881437208379691
                0.00109101572270089
                0.00128420743960603
                0.00119709867439434
                0.00144031324656955
                0.00134802970322647
                0.00101080666166438
                0.000642534951313962
                0.00169818969011704
                0.00159383166446739
                0.00177926121417544
                0.00158434457122651
                0.00180513510483238
                0.00144031324656955
                0.00150068565810241
                0.00168870259687616
                0.00208457312392731
                0.00203455026865723
                0.00229587656429231
                0.00227000267363537
                0.00228983932313902
                0.00164989176089075
                0.00222342967045288
                0.00295134846093474
                0.00263568699492009
                0.00258566413965001
                0.00286855201083254
                0.00255375300783979
                0.00250373015256971
                0.00287890156709531
                0.00340241662138736
                0.00296946018439459
                0.00327649702019026
                0.00303500737405884
                0.0030108584094457
                0.00289183851242378
                0.00282025408160625
                0.00255634039690548
                0.00290046314264276
                0.00213545844221929
                0.00287027693687633
                0.00252097941300767
                0.00220186809490543
                0.0016723157994601
                0.00172923835890536
                0.00184739579290538
                0.00186205766427764
                0.00211044701458425
                0.00207681095673023
                0.00189914357421926
                0.00183100899548932
                0.00199746435871562
                0.00203282534261344
                0.00197504032014627
                0.00209751006925578
                0.00184480840383969
                0.0019621033748178
                0.001673178262482
                0.00144635048772284
                0.00161539324001483
                0.00159383166446739
                0.00171026417242361
                0.0016300551113871
                0.00144548802470094
                0.00166024131715353
                0.00165937885413163
                0.00160331875770826
                0.00153518417897833
                0.00157313255194184
                0.00148602378673014
                0.00147222437837978
                0.0015058604362338
                0.00147308684140167
                0.00157140762589804
                0.00159986890562067
                0.00127472034636515
                0.00118416172906587
                0.000870225189095018
                0.00137045374179582
                0.00132301827559143
                0.00136959127877392
                0.00122297256505127
                0.0010435802564965
                0.00122211010202938
                0.00107721631435052
                0.00128248251356223
                0.00107635385132862
                0.00136355403762064
                0.00120399837856952
                0.00135837925948925
                0.00122987226922646
                0.00119709867439434
                0.00107117907319724
                0.00114535089308046
                0.000976308140788464
                0.00086505041096363
                0.00086073809585414
                0.000851251002613263
                0.000905586172992833
                0.000817614944759243
                0.000842626372394284
                0.000875399967226405
                0.000772766867620551
                0.000805540462452672
                0.000719294160262879
                0.000713256919109593
                0.000733956031635144
                0.000898686468817649
                0.000843488835416182
                0.000712394456087695
                0.000725331401416164
                0.00068134578729937
                0.000708082140978206
                0.000607173967416147
                0.000567500668408842
                0.000694282732627839
                0.000614073671591331
                0.000675308546146084
                0.000621835838788412
                0.00133940507300749
                0
                0.000559738501211761
                0.00069773258471543
                0.000809852777562162
                0.000687383028452655
                0.000502815941766497
                0.000472629736000069
                0.000530414758467231
                0.000488154070394232
                0.000563188353299352
                0.000631322932029289
                0.00046400510578109
                0.00053903938868621
                0.000477804514131457
                0.000603724115328555
                0.000423469343751887
                0.000375171414525602
                0.000352747375956256
                0.000352747375956256
                0.000288925112335809
                0.000412257324467213
                0.000366546784306623
                0.000314799002992747
                0.00035102244991246
                0.000345847671781072
                0.000252701665416095
                0.00027167585189785
                0.000216478218496382
                0.000269950925854054
                0.000175942456467179
                0.000200091421080321
                0.00018370462366426
                0.000146618713722649
                0.000128506990262792
                0.000323423633211726
                0
                0.000136269157459874
                0.000145756250700751
                0.000127644527240895
                0.000113845118890528
                0.000114707581912426
                9.65958584525688e-05
                9.83207844963647e-05
                9.65958584525688e-05
                0.000127644527240895
                0.000105220488671548
                0.000101770636583956
                7.58967459270184e-05
                8.62463021897936e-05
                9.05586172992833e-05
                9.91832475182627e-05
                9.31460063649771e-05
                0.00011298265586863
                6.55471896642431e-05
                8.79712282335895e-05
                0.000107807877737242
                8.53838391678957e-05
                6.98595047737328e-05
                9.14210803211812e-05
                7.93465980146101e-05
                6.7272115708039e-05
                8.19339870803039e-05
                2.84612797226319e-05
                9.91832475182627e-05
                6.81345787299369e-05
                6.03724115328555e-05
                7.58967459270184e-05
                8.19339870803039e-05
                7.41718198832225e-05
                0.000154380880919731
                0
                0.000100045710540161
                0.000106945414715344
                0.000115570044934323
                7.67592089489163e-05
                6.55471896642431e-05
                9.57333954306709e-05
                0.000102633099605854
                0.000118157434000017
                0.000119019897021915
                0.000168180289270098
                8.88336912554874e-05
                0.000142306398613159
                0.000175079993445281
                0.000116432507956221
                0.000141443935591262
                0.000143168861635057
                9.57333954306709e-05
                9.57333954306709e-05
                8.79712282335895e-05
                9.57333954306709e-05
                0.000100045710540161
                0.000111257729824834
                0.000112120192846732
                0.000100045710540161
                0.000146618713722649
                0.000101770636583956
                9.65958584525688e-05
                0.000132819305372282
                0.000119019897021915
                0.00010435802564965
                0.000142306398613159
                0.000260463832613177
                0
                0.000135406694437976
                0.00022165299662777
                0.000153518417897833
                0.00013799408350367
                9.57333954306709e-05
                0.00016300551113871
                0.000140581472569364
                0.000186292012729954
                0.000138856546525568
                0.000150931028832139
                0.000177667382510975
                0.000153518417897833
                0.000149206102788343
                0.000163867974160608
                0.00015869319602922
                0.000156105806963526
                0.000169905215313893
                0.000229415163824851
                0.000156968269985424
                0.000175079993445281
                0.000216478218496382
                0.000198366495036525
                0.000209578514321198
                0.000357922154087644
                0.000392420674963561
                0.00029668727953289
                0.000307036835795665
                0.000291512501401502
                0.000384658507766479
                0.000348435060846766
                0.000281162945138727
                0.000278575556073033
                0.00029668727953289
                0.00033032333738691
                0.000251839202394197
                0.000247526887284708
                0.000348435060846766
                0.000396732990073051
                0.00035533476502195
                0.00038034619265699
                0.000356197228043848
                0.000336360578540195
                0.000368271710350419
                0.000262188758656973
                0.000293237427445298
                0.000337223041562093
                0.000294099890467196
                0.000297549742554788
                0.000283750334204421
                0.000311349150905155
                0.000265638610744564
                0.000253564128437993
                0.000298412205576686
                0.000411394861445316
                0.000344122745737276
                0.00035533476502195
                0.000333773189474501
                0.000319111318102236
                0.000374308951503704
                0.000440718604189845
                0.000363096932219031
                0.000395870527051153
                0.000299274668598584
                0.000452793086496416
                0.000365684321284725
                0.000376896340569398
                0.000410532398423418
                0.000551976334014679
                0.000546801555883292
                0.000439856141167947
                0.000475217125065763
                0.000522652591270149
                0.000489878996438028
                0.000418294565620499
                0.000486429144350436
                0.000443305993255539
                0.00042605673281758
                0.000416569639576703
                0.000363096932219031
                0.000345847671781072
                0.000354472302000052
                0.000412257324467213
                0.000416569639576703
                0.000474354662043865
                0.000326873485299318
                0.000266501073766462
                0.000351884912934358
                0.000323423633211726
                0.000398457916116847
                0.000345847671781072
                0.000367409247328521
                0.000224240385693463
                0.000302724520686176
                0.000312211613927053
                0
                0.000116432507956221
                0.000146618713722649
                8.62463021897936e-05
                7.33093568613246e-05
                6.7272115708039e-05
                4.13982250511009e-05
                5.69225594452638e-05
                4.57105401605906e-05
                5.95099485109576e-05
                1.03495562627752e-05
                2.7598816700734e-05
                3.62234469197133e-05
                2.06991125255505e-05
                0
                1.72492604379587e-05
                1.46618713722649e-05
                6.89970417518349e-06
                0
                2.58738906569381e-06
                2.58738906569381e-06
                0
                5.17477813138762e-06
                1.72492604379587e-06
                0
                4.31231510948968e-06
                0
                6.03724115328555e-06
                1.72492604379587e-06
                0
                8.62463021897936e-07
                8.62463021897936e-07
                0
                8.62463021897936e-07
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                2.58738906569381e-06
        ]
    end

    return v
end

function distribute_vaccine(M1,M2,B,sim)
    braks = get_breaks_vac()
    v,fd,sd = temporal_proportion()

    p2 = Distributions.Categorical(sd[1,:]/sum(sd[1,:]))
    p1 = Distributions.Categorical(fd[1,:]/sum(fd[1,:]))
    ##firstly, let's distribute age-based second doses.
    
    for i in 1:length(braks)
        #println(i)
        pos = findall(y-> y.age in braks[i],humans)

        N = sum(M2[:,i]) ##number of vaccinated
        Vaux = reverse(M2[:,i])
       
        p_day = Distributions.Categorical(Vaux/sum(Vaux))


        n1 = min(N,length(pos))
        pos_vac = sample(pos,n1,replace = false)
        
        ### distributed second dose
        for j in pos_vac
            x = humans[j]
            x.vac_status = 2
            x.vaccine_n = x.age >= 18 ? rand(p2) : 1#rand the vaccine
            x.vaccine = [:pfizer,:moderna,:jensen][x.vaccine_n]
            x.days_vac = rand(p_day) ##rand the day
            x.protected = x.days_vac > p.days_to_protection[x.vaccine_n][x.vac_status][1] ? findfirst(y-> y < x.days_vac,p.days_to_protection[x.vaccine_n][x.vac_status]) : 0
            x.index_day = min(length(p.days_to_protection[x.vaccine_n][x.vac_status]),x.protected+1)

            x.vac_eff_inf = deepcopy(p.vac_efficacy_inf[x.vaccine_n])
            x.vac_eff_symp = deepcopy(p.vac_efficacy_symp[x.vaccine_n])
            x.vac_eff_sev = deepcopy(p.vac_efficacy_sev[x.vaccine_n])

            waning_immunity(x) ##get the immunity
            
            if x.recovered
                index = Int(floor(x.days_recovered/7))

                if index > 0
                    if index <= size(waning_factors_rec,1)
                        aux = waning_factors_rec[index,1]
                    else
                        aux = waning_factors_rec[end,1]
                    end
                else
                    aux = 1.0
                end

                if aux > x.vac_eff_inf[1][x.vac_status][end]
                    x.recvac = 1
                else
                    x.recvac = 2
                end
            end
        end

        N_aux = n1

        pos = findall(y-> y.age in braks[i] && y.vac_status <= 0,humans)
        
        N = sum(M1[:,i]) ##number of vaccinated first dose
        n1 = min(N-N_aux,length(pos)) #number of first dose that didn't take second dose yet
        Vaux = reverse(M1[:,i])
        aux = findfirst(y-> y >= n1, cumsum(Vaux))

        p_day = Distributions.Categorical(Vaux[1:aux]/sum(Vaux[1:aux]))

        pos_vac = sample(pos,n1,replace = false)
        
        for j in pos_vac
            #println(j)
            x = humans[j]
            x.vac_status = 2 #let's set everybody to second dose
            
            x.vaccine_n = x.age >= 18 ? rand(p1) : 1#rand the vaccine
                
            x.vaccine = [:pfizer,:moderna,:jensen][x.vaccine_n]
            x.days_vac = 0#rand(p_day) ##rand the day
            x.protected = x.days_vac > p.days_to_protection[x.vaccine_n][x.vac_status][1] ? findfirst(y-> y < x.days_vac,p.days_to_protection[x.vaccine_n][x.vac_status]) : 0
            x.index_day = min(length(p.days_to_protection[x.vaccine_n][x.vac_status]),x.protected+1)

            x.vac_eff_inf = deepcopy(p.vac_efficacy_inf[x.vaccine_n])
            x.vac_eff_symp = deepcopy(p.vac_efficacy_symp[x.vaccine_n])
            x.vac_eff_sev = deepcopy(p.vac_efficacy_sev[x.vaccine_n])

            if x.recovered
                index = Int(floor(x.days_recovered/7))

                if index > 0
                    if index <= size(waning_factors_rec,1)
                        aux = waning_factors_rec[index,1]
                    else
                        aux = waning_factors_rec[end,1]
                    end
                else
                    aux = 1.0
                end

                if aux > x.vac_eff_inf[1][x.vac_status][end]
                    x.recvac = 1
                else
                    x.recvac = 2
                end
            end
        end
        

    end #end for age breaks
    

    ### now I want to distribute booster
    Baux = reverse(B)
    for i = 1:length(Baux)
        pos = findall(y-> y.vac_status == 2 && y.n_boosted == 0 && y.days_vac >= p.booster_after[y.vaccine_n]+(i-1) && y.age >= p.min_age_booster,humans)

        n1 = min(Baux[i],length(pos))
        pos_vac = sample(pos,n1,replace = false)
        for j in pos_vac
            x = humans[j]
            x.days_vac = (i-1) ##rand the day
            x.protected = length(p.days_to_protection[x.vaccine_n][x.vac_status])
            x.index_day = min(length(p.days_to_protection[x.vaccine_n][x.vac_status]),x.protected+1)
            x.n_boosted += 1
            x.boosted = true
            #### ADD here the new vaccine efficacy against Omicron for booster
                
            x.vac_eff_inf[3][2][end] = [0.76;0.677][x.vaccine_n]
            x.vac_eff_symp[3][2][end] = 0.82
            x.vac_eff_sev[3][2][end] = 0.90
            #moderna has a different value against Delta for booster
            x.vac_eff_inf[2][2][end] = [x.vac_eff_inf[2][2][end]; 0.94][x.vaccine_n]

            if x.recovered
                index = Int(floor(x.days_recovered/7))

                if index > 0
                    if index <= size(waning_factors_rec,1)
                        aux = waning_factors_rec[index,1]
                    else
                        aux = waning_factors_rec[end,1]
                    end
                else
                    aux = 1.0
                end

                if aux > x.vac_eff_inf[1][x.vac_status][end]
                    x.recvac = 1
                else
                    x.recvac = 2
                end
            end
        end

    end

    ## Let's boost a XX% of the working-age population on day 0, following the order of the
    # earlier vaccinated to the later

    ## Let's find the number of boosted people
    pos = findall(y-> y.n_boosted == 1 && y.age in 18:65,humans)
    NN = Int(round(length(pos)*(p.extra_booster/100))) # This is the number of extra booster we want to give

    ##Let's find everybody who can be boosted
    pos = findall(y-> y.vac_status == 2 && y.age in 18:65 && y.n_boosted == 0,humans)

    days = [x.days_vac for x in humans[pos]]
    pos_days = sortperm(days,rev=true)
    ranpos = pos[pos_days]

    rng = MersenneTwister(200*sim)
    NN = min(NN,length(ranpos)) ## making sure we are capping the boosters

    max_b = length(B)-findfirst(yy-> yy > 0, B)

    for i in ranpos[1:NN]
        x = humans[i]
        dd = max(0,min((x.days_vac-p.booster_after[x.vaccine_n]),max_b))
        x.days_vac = rand(rng,0:dd) ##rand the day
        x.protected = length(p.days_to_protection[x.vaccine_n][x.vac_status])
        x.index_day = min(length(p.days_to_protection[x.vaccine_n][x.vac_status]),x.protected+1)
        x.n_boosted += 1
        x.boosted = true
        #### ADD here the new vaccine efficacy against Omicron for booster
            
        x.vac_eff_inf[3][2][end] = [0.76;0.677][x.vaccine_n]
        x.vac_eff_symp[3][2][end] = 0.82
        x.vac_eff_sev[3][2][end] = 0.90
        #moderna has a different value against Delta for booster
        x.vac_eff_inf[2][2][end] = [x.vac_eff_inf[2][2][end]; 0.94][x.vaccine_n]

        if x.recovered
            index = Int(floor(x.days_recovered/7))

            if index > 0
                if index <= size(waning_factors_rec,1)
                    aux = waning_factors_rec[index,1]
                else
                    aux = waning_factors_rec[end,1]
                end
            else
                aux = 1.0
            end

            if aux > x.vac_eff_inf[1][x.vac_status][end]
                x.recvac = 1
            else
                x.recvac = 2
            end
        end
    end
  

    for x in humans
        vac_update(x)
    end

end

function _get_prob_test(x::Human,test::Int64)
    M = [
                [   0.0 0.0 0.0 0.0
                    0.009313509049	0.006866032934	0.007803657586	0.006417272611
                    0.2133219625	0.1674016942	0.1849936843	0.156460407
                    0.6245252906	0.5130620215	0.5557634429	0.4795285561
                    0.9094660428	0.7705126222	0.8237454819	0.7201523201
                    0.9945486441	0.8564832076	0.9093758818	0.8005039129
                    0.9503184103	0.8081819529	0.8626342295	0.755359603
                    0.8529628037	0.7118894356	0.7659344442	0.6653607143
                    0.7383576935	0.603564619	0.655203656	0.5641159511
                    0.6251870297	0.4994661735	0.5476296564	0.4668213255
                    0.5222683805	0.406840421	0.4510607097	0.3802495438
                    0.4327828139	0.3279132583	0.3680886373	0.3064810192
                    0.3570004322	0.262403805	0.2986436396	0.2452532295
                    0.2938391141	0.2089335229	0.2414607353	0.195277737
                    0.2417041863	0.1657670756	0.1948584758	0.1549326262
                    0.1989147335	0.1311755865	0.1571263583	0.1226020187
                    0.1639024422	0.1035960831	0.1266993644	0.09682509731
                    0.1352899444	0.08168561917	0.1022213607	0.07634668981
                    0.1119081936	0.06432400653	0.08255344156	0.06011982309
                    0.09278515497	0.05059383758	0.06675727185	0.04728705081
                    0.07712282177	0.03975252979	0.05406903601	0.03715432523
                    0.06427118563	0.03120358389	0.04387173554	0.02916413396
                    0.05370326396	0.02447025831	0.0356693816	0.02287089502
                    0.04499289969	0.01917281454	0.0290644528	0.01791968941
                    0.03779583422	0.01500948652	0.02373890423	0.01402847433
                    0.03183396993	0.01174087775	0.01943851306	0.01097350012
                    0.02688248769	0.009177324883	0.01596014782	0.008577499727
                    0.02275940604	0.007168740988	0.01314150281	0.006700195825
                    0.0193171719	0.005596489183	0.01085286341	0.005230705576
                    0.01643591315	0.004366898205	0.008990520833	0.004081480021
                    0.01401803578	0.00340609601	0.00747151519	0.003183475356
                ],
                [   0.0  0.0    0.0     0.0
                    5.94E-24	3.03E-24	4.15E-24	2.83E-24
                    0.04537575679	0.03469964287	0.03878964707	0.03243169235
                    0.5771005809	0.4739293861	0.5134541255	0.4429536092
                    0.9698884535	0.8302904859	0.8837702707	0.7760231338
                    0.9443993144	0.8022078431	0.8566811955	0.749775958
                    0.8233996036	0.6836634575	0.7371961783	0.6389795714
                    0.6858166375	0.5549744412	0.6050999023	0.5187016019
                    0.5567983372	0.4377366611	0.4833490215	0.4091264218
                    0.4457423584	0.3392709461	0.3800599942	0.3170963744
                    0.3542541276	0.2600777151	0.2961565661	0.2430791716
                    0.2806701888	0.1979565899	0.2296440531	0.1850182507
                    0.2222605315	0.1499579621	0.1776569746	0.1401567881
                    0.1762126958	0.1132199967	0.137352411	0.1058199969
                    0.1400186026	0.08527180026	0.1062452231	0.07969847998
                    0.1115847481	0.06409714608	0.08228957952	0.05990779012
                    0.08922367794	0.04810081486	0.06385492579	0.04495697076
                    0.07160155294	0.03604309054	0.0496654874	0.03368733299
                    0.05767555577	0.02697081247	0.03873375638	0.02520801427
                    0.04663514342	0.02015592802	0.03030007814	0.0188385471
                    0.03785194957	0.0150446121	0.02378207096	0.01406130412
                    0.03083908088	0.01121672029	0.018734019	0.01048360132
                    0.0252189225	0.008354156388	0.01481502453	0.007808133094
                    0.02069806833	0.00621648879	0.01176436151	0.005810182333
                    0.01704797318	0.004622278041	0.009382544347	0.004320168365
                    0.01409009342	0.003434827613	0.007516844935	0.003210329076
                    0.01168449971	0.00255132964	0.006050234228	0.002384576068
                    0.009721153956	0.001894605326	0.004892945083	0.001770774913
                    0.008113221643	0.001406825338	0.003976036317	0.00131487597
                    0.006791935941	0.001044740692	0.003246483097	0.0009764569867
                    0.005702644631	0.0007760660642	0.002663431374	0.000725342792
                ],
                [0.0    0.0     0.0     0.0
                    0.001579516574	0.001147900706	0.001313252137	0.001072874516
                    0.3515219715	0.2837658214	0.3097231071	0.2652190357
                    0.9313050383	0.7927100947	0.8458056224	0.7408989774
                    0.9472396481	0.80500906	0.859497398	0.7523940888
                    0.826809351	0.6869122607	0.740506639	0.6420160345
                    0.689613994	0.5584707646	0.6087115511	0.5219694074
                    0.5605052675	0.4410625185	0.4868208674	0.4122349029
                    0.4491261986	0.342235074	0.3831849133	0.3198667685
                    0.3572269169	0.2626191882	0.2988632759	0.2454545354
                    0.2832220522	0.2000824973	0.2319331437	0.1870052099
                    0.2244198366	0.1517068941	0.17956312	0.1417914109
                    0.1780236379	0.1146419819	0.138923405	0.1071490419
                    0.1415292607	0.0864179487	0.1075310147	0.08076971676
                    0.112841149	0.06501475526	0.08333697935	0.06076542485
                    0.09026718756	0.04883143365	0.06470541261	0.04563983668
                    0.07246804105	0.03662210908	0.05035463513	0.03422850718
                    0.058395458	0.02742778848	0.03929145906	0.02563512257
                    0.04723393372	0.02051522135	0.03075112243	0.01917435721
                    0.03835076592	0.01532610804	0.02414682205	0.01432440163
                    0.03125536897	0.01143653285	0.01902910105	0.01068904704
                    0.02556703536	0.008525265222	0.01505394336	0.007968058345
                    0.02098979537	0.006349293846	0.01195804936	0.00593430732
                    0.017292993	0.004725071876	0.009539824757	0.004416243649
                    0.01429635378	0.003514191875	0.007644822913	0.003284506131
                    0.01185853248	0.002612464756	0.006154620279	0.002441715425
                    0.009868334106	0.001941602583	0.004978322265	0.001814700454
                    0.008237978975	0.001442890037	0.004046079039	0.001348583499
                    0.006897927816	0.001072374053	0.003304135494	0.001002284245
                    0.00579289648	0.0007972126095	0.002711052064	0.0007451072101
                    0.004878778883	0.0005929083608	0.002234819322	0.0005541561804
                ]
    ] #end M
    #
    #
    #1 - RT-PCR, 2 - Abbott_PanBio 3 - BTNX_Rapid_Response	4 - Artron
    if x.daysinf+1 > size(M[1],1)
        d = 1
        pp = [0.001 0.002 0.002 0.002]#[0.005 0.015 0.015 0.015]
        prob = pp[1,test]
        
    else
        #Let's create a Tuple with one matrix for each strain
        d = x.daysinf+1 #first row is 0
        prob = M[x.strain][d,test]
    end

    
    return prob
end

